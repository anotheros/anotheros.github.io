{"version":3,"sources":["components/header/index.jsx","util/constant.js","util/fetch.js","api/user.js","util/websocketHelper.js","i18n.js","util/helper.js","store/reducer.js","store/store.js","components/goboard/Coord.js","components/goboard/Grid.js","components/goboard/Vertex.js","components/goboard/Line.js","components/goboard/Goban.js","util/storage.js","util/gtp.js","api/battle.js","components/sgf/index.jsx","util/sgf/fn.js","components/gobanboard/operatorPanel.jsx","components/gobanboard/index.jsx","components/externalSGF/index.jsx","components/leftpanel/index.jsx","components/nodeTreeGraph/index.jsx","components/rightpanel/index.jsx","api/mock.js","components/routes/home/index.jsx","components/login/index.jsx","components/register/index.jsx","components/app.jsx","index.js","util/sgf/iconv-lite.js","util/sgf/jschardet.js","util/sgf/helper.js","util/sgf/tokenize.js","util/sgf/peekable.js","util/sgf/parse.js","util/sgf/stringify.js","util/sgf/main.js","components/goboard/helper.js"],"names":["Header","useTranslation","t","i18n","changeLanguage","lng","loginStatus","Cookies","get","menu","style","background","className","color","Item","type","onClick","to","set","overlay","e","preventDefault","DownOutlined","EmptyMap","GameMode","jointUrl","url","getResponse","res","a","success","ok","succcess","status","json","data","post","params","fetch","method","body","JSON","stringify","headers","catch","error","console","log","getWithoutServerAddr","login","usr","pwd","userName","passWord","resRaw","registry","checkAuth","WebSocketHelper","socketUrl","event","auth","authSession","this","ws","WebSocket","addEventListener","warn","callback","close","use","LanguageDetector","initReactI18next","init","resources","en","translation","enUsTrans","zhCn","zhCnTrans","zhTc","zhTcTrans","ja","jaJpTrans","ko","koKrTrans","fallbackLng","debug","interpolation","escapeValue","get10TimeStamp","String","Date","getTime","substring","windowModalComp","title","content","finishFn","cancelFn","okText","cancelText","tTitle","translate","tContent","tFinishFn","tCancelFn","tOkText","tCancelText","Modal","confirm","onOk","onCancel","info","stackpush","arr","el","len","length","shift","push","keyWord","lang","getCurrentLanguage","trans","language","open","createAction","addData","reset","deleteOne","gameStatus","gobackN","dataReducer","createReducer","kataDataStatus","kataData","builder","addCase","state","action","pop","id","configureStore","reducer","h","react","createElement","Component","alpha","helper","CoordX","props","xs","coordX","i","Object","assign","display","textAlign","map","key","width","CoordY","height","ys","coordY","Grid","nextProps","vertexSize","hoshis","halfVertexSize","fl","Math","floor","position","top","left","zIndex","_","x","y","indexOf","j","join","cx","cy","r","vertexEvents","absoluteStyle","Vertex","evt","random","sign","selected","heat","paint","dimmed","marker","ghostStone","animate","selectedLeft","selectedRight","selectedTop","selectedBottom","markerMarkup","z","label","classnames","strength","includes","faint","eventName","opacity","abs","text","toString","vertexEquals","Line","v1","v2","v","pos1","pos2","dx","dy","angle","atan2","PI","sqrt","margin","transform","Coord","Goban","animateStonePlacement","clearAnimatedVerticesHandler","animatedVertices","shiftMap","readjustShifts","setState","setTimeout","animationDuration","rangeX","rangeY","randomMap","innerProps","busy","signMap","paintMap","heatMap","markerMap","ghostStoneMap","fuzzyStonePlacement","showCoordinates","lines","selectedVertices","dimmedVertices","concat","neighborhood","class","gridTemplateRows","gridTemplateColumns","fontSize","lineHeight","gridRow","gridColumn","right","bottom","equalsVertex","some","overflow","pointerEvents","getDerivedStateFromProps","Infinity","diffSignMap","result","range","slice","getHoshis","row","value","localStorage","Array","isArray","setItem","getItem","require","Command","ControllerStateTracker","Controller","Response","gtpParse","gtpString","fromString","decompress","socket","commonFn","str2ab","str","buf","ArrayBuffer","bufView","Uint16Array","strLen","charCodeAt","sendTimeout","checkSocket","readyState","location","reload","finishBoard","clearBoard","board","setBoard","setGameStatus","setStartGame","genPlayMessage","code","pos","newPos","setMapBoard","playChessManual","chessManual","cmd","sendCommonGtp","setLoading","msg","aiId","parseInt","gtpId","jsonData","send","kataAnalyze","gameAnalysis","initBoardFromMap","nodeList","initBoardStatus","commondList","forEach","item","B","makeMove","W","aiPlay","gtpMessage","askHelp","defineMessage","shareData","ackGtpId","clearTimeout","blobData","reader","FileReader","readAsArrayBuffer","unit8data","Uint8Array","fromCharCode","apply","parse","split","step1","lastGtp","isInitGame","nextStepGtp","seq","playOperation","initBoard","stepWin","gtpObj","name","parseWinAndLose","step2","showAlert","args","getAIPlay","addNewNode","posRaw","xCode","yCode","signChar","newBoard","dispatch","currentGameTree","root","parseAIResult","serverGtpObj","handleWrongGtp","gtpInfo","infoData","indicator","indicatorList","infoList","eachInfo","pv","isIndicator","ind","move","parseAnalysis","sgf","FileSaver","convertTable","A","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","X","Y","Z","b","c","d","f","g","k","l","m","n","o","p","q","s","u","w","ReadSGF","accept","beforeUpload","file","readAsText","onload","target","showUploadList","icon","UploadOutlined","SaveSGF","DownloadOutlined","alert","linebreak","blob","Blob","saveAs","saveFile","SGFPlayedNodeList","getSGFPlayedNodeList","clearSGFPlayedNodeList","vertex","newTree","getHeight","stepNum","mutate","draft","addToProperty","stringifyVertex","appendNode","treePosition","initGameStatus","emptyTree","CP","readSGFTree","lastId","totalNodeNum","reg","RegExp","match","getTotalNodesNum","getId","gameTrees","rootNode","GameTree","parseNodeData","Node","posStr","Battle","checkNoSGF","getNodeDataAtPosition","node","OperatorPanel","mode","startGame","historyBoardList","setHistoryBoardList","futureBoardList","setFutureBoardList","lastNode","setLastNode","placement","disabled","BackwardOutlined","lastBoard","SGF","historyBoard","tmp","HumanVSComputer","HumanVSComputerWithFriend","Free","CaretLeftOutlined","CaretRightOutlined","ForwardOutlined","QuestionOutlined","ClearOutlined","CustomGobangBoard","uploadState","useState","loading","Board","bindMessage","setBindMessage","message","setMessage","useDispatch","clear","newGameStatus","nodeArray","useMount","useEffect","removeEventListener","time","tip","onVertexMouseUp","button","isLegal","isBusy","consoleLog","Option","Select","ExternalSGF","undefined","setValue","searchValue","setSearchValue","placeholder","setPlaceholder","setOpen","notFoundContent","setNotFoundContent","candidatesList","setCandidatesList","candidatesNameList","setCandidatesNameList","fromFocusFlag","setFromFocusFlag","ref","React","createRef","fetchSGFList","keyword","tmpCandidatesNameList","index","fetchSGF","sgfUrl","option","sgfTextTmp","sgfText","current","focus","showSearch","minWidth","onSearch","onChange","onBlur","suffixIcon","filterOption","shape","SearchOutlined","handleClickSearch","GameModeList","changeGameMode","Group","aimMode","size","buttonStyle","Button","GameAISelect","optionList","setOptionList","nowAIText","setNowAIText","nowAI","getFetch","tmpOptionList","chooseAI","LeftPanel","setGameAnalysis","NodeTreeGraph","graphRef","useRef","graph","setGraph","G6","TreeGraph","container","ReactDOM","findDOMNode","modes","default","defaultNode","fill","stroke","labelCfg","defaultEdge","layout","direction","nodeSep","rankSep","padding","fitView","render","changeData","reconstruct","obj","prototype","call","children","RightPanel","setLineData","setLineConfig","gameTreeNode","useSelector","possibility","xField","yField","autoFit","point","treeData","Home","gameMode","setGameMode","history","useHistory","setWs","childrenState","setChildrenState","childrenStateFn","setChildrenStateFn","wsHelper","store","setStateFn","errorModal","LoginSignup","setName","password","setPassword","repeatPassword","setRepeatPassword","loginInLeftPanel","setLoginInLeftPanel","signin","AuthToken","UserName","UserId","signUp","changePanel","href","labelCol","span","wrapperCol","tailLayout","offset","Registry","registryAccount","onFinish","onFinishFailed","rules","required","Password","htmlType","App","backgroundColor","exact","path","StrictMode","document","getElementById","iconv","Error","err","encodingExists","decode","buffer","encode","jschardet","detect","encoding","parseVertex","input","sgfHelper","escapeString","replace","unescapeString","inBackslash","parseDates","trim","dates","date","prev","unshift","stringifyDates","datesCopy","min","max","parseCompressedVertices","colon","x1","y1","x2","y2","vertices","_tokenize","createTokenizer","regexRule","lineBreaks","tokenizeIter","contents","token","progress","tokenizeBufferIter","detectedEncoding","tokens","prelude","next","done","lastToken","encodingDetectionProps","tokenize","tokenizeBuffer","opts","Peekable","iterator","Symbol","peekedItem","peeked","_parseTokens","peekableTokens","parentId","options","property","dictionary","onProgress","onNodeCreated","anchor","peek","col","identifier","toUpperCase","filter","child","parseTokens","parseLib","parseBuffer","indent","level","output","totalIndent","repeat","tokenizelib","lineEquals","w1","w2","nearX","nearY","farX","farY","middleX","middleY","directions","qx","qy","removeShifts","before","after"],"mappings":"8NAQMA,EAAS,WACb,MAAkBC,cAAXC,EAAP,EAAOA,EAAGC,EAAV,EAAUA,KAEJC,EAAiB,SAACC,GACtBF,EAAKC,eAAeC,IAGhBC,EAAcC,IAAQC,IAAI,QAE1BC,EACJ,eAAC,IAAD,CAAMC,MAAO,CAACC,WAAY,QAASC,UAAU,YAAYC,MAAM,OAA/D,UACE,cAAC,IAAKC,KAAN,UACE,cAAC,IAAD,CAAQC,KAAK,OAAOC,QAAW,WAC7BZ,EAAe,SADjB,uCADa,KAOf,cAAC,IAAKU,KAAN,UACE,cAAC,IAAD,CAAQC,KAAK,OAAOC,QAAW,WAC7BZ,EAAe,SADjB,uCADa,KAOf,cAAC,IAAKU,KAAN,UACE,cAAC,IAAD,CAAQC,KAAK,OAAOC,QAAW,WAC7BZ,EAAe,OADjB,iCADa,KAOf,cAAC,IAAKU,KAAN,UACE,cAAC,IAAD,CAAQC,KAAK,OAAOC,QAAW,WAC7BZ,EAAe,OADjB,sBADa,KAOf,cAAC,IAAKU,KAAN,UACE,cAAC,IAAD,CAAQC,KAAK,OAAOC,QAAW,WAC7BZ,EAAe,OADjB,iCADa,QAUnB,OACE,yBAAQQ,UAAU,SAAlB,UACE,6BAAKV,EAAE,wBACP,gCAEE,cAAC,IAAD,CAASe,GAAG,QAAZ,SAAqBf,EAAE,mBACrBI,GAAe,cAAC,IAAD,CAASW,GAAG,SAAZ,SAAsBf,EAAE,kBACxCI,GAAe,cAAC,IAAD,CAASW,GAAG,SAASD,QAAS,WAC5CT,IAAQW,IAAI,OAAQ,MACpBX,IAAQW,IAAI,WAAY,MACxBX,IAAQW,IAAI,SAAU,OAHR,SAIZhB,EAAE,kBAGN,cAAC,IAAD,CAAUiB,QAASV,EAAnB,SACE,oBAAGG,UAAU,oBAAoBI,QAAS,SAACI,GAAD,OAAOA,EAAEC,kBAAnD,UACGnB,EAAE,4BADL,IACc,cAACoB,EAAA,EAAD,gB,6ECzEXC,EAAW,CACtB,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,E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","file":"static/js/main.1f774588.chunk.js","sourcesContent":["import {NavLink} from 'react-router-dom';\nimport './style.css';\nimport Cookies from 'js-cookie';\nimport {Menu, Dropdown, Button} from 'antd';\nimport {DownOutlined} from '@ant-design/icons';\nimport {useTranslation} from 'react-i18next';\n\n\nconst Header = () => {\n  const {t, i18n} = useTranslation();\n\n  const changeLanguage = (lng) => {\n    i18n.changeLanguage(lng);\n  };\n\n  const loginStatus = Cookies.get('auth');\n\n  const menu = (\n    <Menu style={{background: '#000'}} className='lang-menu' color=\"#000\">\n      <Menu.Item key=\"0\">\n        <Button type='text' onClick = {()=>{\n          changeLanguage('zhCn');\n        }}>\n          简体中文\n        </Button>\n      </Menu.Item>\n      <Menu.Item key=\"1\">\n        <Button type='text' onClick = {()=>{\n          changeLanguage('zhTc');\n        }}>\n          繁體中文\n        </Button>\n      </Menu.Item>\n      <Menu.Item key=\"2\">\n        <Button type='text' onClick = {()=>{\n          changeLanguage('ko');\n        }}>\n          한국어\n        </Button>\n      </Menu.Item>\n      <Menu.Item key=\"3\">\n        <Button type='text' onClick = {()=>{\n          changeLanguage('en');\n        }}>\n          English\n        </Button>\n      </Menu.Item>\n      <Menu.Item key=\"5\">\n        <Button type='text' onClick = {()=>{\n          changeLanguage('ja');\n        }}>\n          日本語\n        </Button>\n      </Menu.Item>\n    </Menu>\n  );\n\n  return (\n    <header className='header'>\n      <h1>{t('Katago围棋')}</h1>\n      <nav>\n        {/* [TODO] 点击后为激活的Link的className添加active */}\n        <NavLink to=\"/home\">{t('对弈')}</NavLink>\n        {!loginStatus && <NavLink to=\"/login\">{t('登录')}</NavLink>}\n        {loginStatus && <NavLink to=\"/login\" onClick={()=>{\n          Cookies.set('auth', null);\n          Cookies.set('userName', null);\n          Cookies.set('userId', null);\n        }}>{t('注销')}</NavLink>}\n        {/* <NavLink to=\"/registry\">注册</NavLink> */}\n        {/* 多语言切换 */}\n        <Dropdown overlay={menu}>\n          <a className=\"ant-dropdown-link\" onClick={(e) => e.preventDefault()}>\n            {t('语言切换')} <DownOutlined />\n          </a>\n      </Dropdown>\n      </nav>\n    </header>\n  );\n};\n\n\nexport {\n  Header,\n};\n","export const EmptyMap = [\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n];\nexport const gtpPath = '/leela';\n// websocket地址\nexport const webSocketAddr = 'wss://wss2.katagg.com';\n// api地址\nexport const serverAddr = 'https://api2.katagg.com';\nexport const GameMode = {\n  'HumanVSComputer': 'HumanVSComputer',\n  'HumanVSComputerWithFriend': 'HumanVSComputerWithFriend',\n  'Free': 'Free',\n  'SGF': 'SGF',\n};\n\nexport const aiAddr = '/ai/';\n","import Cookies from 'js-cookie';\nimport {serverAddr} from './constant';\nexport function jointUrl(url) {\n  return serverAddr + url;\n}\nexport const getResponse = async (res) => {\n  if (!res) {\n    return {success: false};\n  }\n  if (!res.ok) {\n    return {succcess: false, status: res.status};\n  }\n  return {success: true, status: res.status, data: await res.json()};\n};\n\nexport const getResponseText = async (res) => {\n  if (!res) {\n    return {success: false};\n  }\n  if (!res.ok) {\n    return {succcess: false, status: res.status};\n  }\n  return {success: true, status: res.status, data: await res.text()};\n};\n\nexport const post = function(url, params) {\n  return fetch(jointUrl(url), {\n        method: 'post',\n        body: JSON.stringify(params),\n        headers: {\n          'Content-type': 'application/json; charset=UTF-8',\n          'Auth': Cookies.get('auth'),\n        },\n    }).catch((error) => {\n      console.log('[error] fetch error:', error);\n    });\n};\n\nexport const get = function(url) {\n  return fetch(jointUrl(url), {\n      method: 'get',\n    }).catch((error) => {\n      console.log('[error] fetch error:', error);\n    });\n};\n\nexport const getWithoutServerAddr = function(url) {\n  return fetch(url, {\n      method: 'get',\n    }).catch((error) => {\n      console.log('[error] fetch error:', error);\n    });\n};\n","import {post, getResponse} from '../util/fetch';\n\n\nconst mockData = {\n  registry: {\n    AuthToken: 'f670g3xwQ90GsHymPIXtSpNW6f-yfW8vukvL_Y4kIJ8=',\n    Code: 0,\n    CreateTime: '2021-04-20T01:19:40.147616761+08:00',\n    UserId: 34474,\n    UserName: 'test_123123',\n    Vip: false,\n    VipExpire: '2021-04-20T01:19:40.147616922+08:00',\n  },\n  login: {\n    'Code': 0,\n    'AuthToken': 'c7BXgJPc_IjR08aD--CtF093EHCJ1WFTl5_Rr4m1z4g=',\n    'UserId': 34668,\n    'UserName': 'testgoban',\n    'CreateTime': '2021-04-23T00:08:05+08:00',\n    'Vip': false,\n    'VipExpire': '2021-04-23T00:08:05+08:00',\n  },\n};\n\n\nasync function login(usr, pwd) {\n  const params = {\n    userName: usr,\n    passWord: pwd,\n  };\n  console.log('[API] Login params: ', params);\n  const resRaw = await post('/user/login', params);\n  console.log('[API] Login: ', params, resRaw);\n  const res = await getResponse(resRaw);\n  return res;\n}\n\nasync function registry(usr, pwd) {\n  const params = {\n    userName: usr,\n    passWord: pwd,\n  };\n  const resRaw = await post('/user/register', params);\n  console.log('[API] Register: ', params, resRaw);\n  const res = await getResponse(resRaw);\n  return res;\n}\n\nasync function checkAuth() {\n  const resRaw = await post('/user/checkAuth', {});\n  console.log('[API] CheckAuth: ', {}, resRaw);\n  const res = await getResponse(resRaw);\n  return res;\n}\n\nexport {\n  login,\n  registry,\n  checkAuth,\n};\n","import Cookies from 'js-cookie';\n\nexport default class WebSocketHelper {\n  constructor(socketUrl, event = {}, auth = true) {\n    console.log('[WebSocket] create a new websocket:', socketUrl);\n    try {\n      if (auth) {\n        const authSession = Cookies.get('auth');\n        if (!authSession || authSession === 'undefined') {\n          console.log('[Auth] Fail to create websocket, no auth', authSession);\n          return false;\n        }\n        this.ws = new WebSocket(socketUrl+ `?Auth=${authSession}`);\n      } else {\n        this.ws = new WebSocket(socketUrl);\n      }\n      // 给ws注册默认事件\n      for (const e in event) {\n        if (e) {\n          this.ws.addEventListener(e, event[e]);\n        }\n      }\n    } catch (e) {\n      console.warn('websocket初始化失败', e);\n    }\n  }\n  // 订阅新的事件\n  subscribe(event, callback) {\n    this.ws.addEventListener(event, callback);\n  }\n  // 取消订阅事件\n  unsubscribe(event) {\n    this.ws[event] = null;\n  }\n  // 关闭websocket\n  close() {\n    this.ws.close();\n    this.ws = null;\n  }\n  // (重新)开启一个全新的socket\n  start(socketUrl, event) {\n    if (!socketUrl || this.ws!=null) {\n      return false;\n    }\n    this.ws = new WebSocket(socketUrl);\n    for (const e of event) {\n      this.ws[e] = event[e];\n    }\n  }\n};\n","import LanguageDetector from 'i18next-browser-languagedetector';\nimport i18n from 'i18next';\nimport enUsTrans from './assets/locales/en-us.json';\nimport zhCnTrans from './assets/locales/zh-cn.json';\nimport zhTcTrans from './assets/locales/zh-tc.json';\nimport jaJpTrans from './assets/locales/ja-jp.json';\nimport koKrTrans from './assets/locales/ko-kr.json';\nimport {\n  initReactI18next,\n} from 'react-i18next';\n\ni18n.use(LanguageDetector) // 嗅探当前浏览器语言\n.use(initReactI18next) // init i18next\n.init({\n  // 引入资源文件\n  resources: {\n    en: {\n      translation: enUsTrans,\n    },\n    zhCn: {\n      translation: zhCnTrans,\n    },\n    zhTc: {\n      translation: zhTcTrans,\n    },\n    ja: {\n      translation: jaJpTrans,\n    },\n    ko: {\n      translation: koKrTrans,\n    },\n  },\n  // 选择默认语言，选择内容为上述配置中的key，即en/zh\n  fallbackLng: 'zh',\n  debug: false,\n  interpolation: {\n    escapeValue: false, // not needed for react as it escapes by default\n  },\n});\n\nexport default i18n;\n","import {Modal} from 'antd';\nimport i18n from '../i18n';\nimport enUsTrans from '../assets/locales/en-us.json';\nimport zhCnTrans from '../assets/locales/zh-cn.json';\nimport zhTcTrans from '../assets/locales/zh-tc.json';\nimport jaJpTrans from '../assets/locales/ja-jp.json';\nimport koKrTrans from '../assets/locales/ko-kr.json';\n\nconst isObject = (obj) => {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n};\n\nconst str2ab = (str) => {\n  const buf = new ArrayBuffer(str.length*2); // 每个字符占用2个字节\n  const bufView = new Uint16Array(buf);\n  for (let i=0, strLen=str.length; i<strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n};\n\nconst get10TimeStamp = () => {\n  return String(new Date().getTime()).substring(0, 10);\n};\n\n// 全局弹窗提示组件\n// const windowModalComp = (title = '提示', content, finishFn, cancelFn, okText, cancelText) => {\nconst windowModalComp = (title, content, finishFn, cancelFn, okText, cancelText) => {\n  const tTitle = translate(title);\n  const tContent = translate(content);\n  const tFinishFn = translate(finishFn);\n  const tCancelFn = translate(cancelFn);\n  const tOkText = translate(okText);\n  const tCancelText = translate(cancelText);\n  if (cancelFn && cancelText) {\n    Modal.confirm({\n      // [DEMO] 函数式调用语言切换: translate(关键字) --> 目标语言; 需提前在语言库中加对应关键字\n      title: tTitle,\n      content: tContent,\n      onOk: tFinishFn,\n      onCancel: tCancelFn,\n      okText: tOkText,\n      cancelText: tCancelText,\n    });\n    return;\n  }\n  // 普通提示框\n  Modal.info({\n    title: tTitle,\n    content: tContent,\n    onOk: tFinishFn,\n    onCancel: tCancelFn,\n    okText: tOkText,\n    cancelText: tCancelText,\n  });\n};\n\n// 控制数组栈的长度来push\nconst stackpush = (arr, el, len = 10) => {\n  if (!arr) {\n    return null;\n  }\n  if (arr.length === len) {\n    // 超过长度上限,挤掉一个\n    arr.shift();\n    arr.push(el);\n  } else {\n    arr.push(el);\n  }\n};\n\nconst translate = (keyWord) => {\n  const lang = getCurrentLanguage() || zhCnTrans; // 默认中文\n  let trans = zhCnTrans;\n  if (lang === 'zhCn' || lang === 'zh' || lang === 'zh-CN') {\n    trans = zhCnTrans;\n  } else if (lang === 'en' || lang === 'en-US') {\n    trans = enUsTrans;\n  } else if (lang === 'zhTc' || lang === 'zh-TC') {\n    trans = zhTcTrans;\n  } else if (lang === 'ja') {\n    trans = jaJpTrans;\n  } else if (lang === 'ko') {\n    trans = koKrTrans;\n  }\n  return trans[keyWord]?trans[keyWord]:keyWord;\n};\n\nconst getCurrentLanguage = () => {\n  return i18n.language;\n};\n\nexport {\n  isObject,\n  str2ab,\n  get10TimeStamp,\n  windowModalComp,\n  stackpush,\n  translate,\n};\n","import {createAction, createReducer} from '@reduxjs/toolkit';\n\nconst open = createAction('kataData/open');\nconst close = createAction('kataData/close');\nconst addData = createAction('kataData/addData');\nconst reset = createAction('kataData/reset');\nconst deleteOne = createAction('kataData/deleteOne');\nconst gameStatus = createAction('kataData/gameStatus');\nconst gobackN = createAction('kataData/gobackN');\n\n\nconst initialState = {kataDataStatus: false, kataData: [], gobackN: null, gameStatus: null};\n\nconst dataReducer = createReducer(initialState, (builder) => {\n  builder\n    .addCase(open, (state, action) => {\n      state.kataDataStatus = true;\n    })\n    .addCase(close, (state, action) => {\n      state.kataDataStatus = false;\n    })\n    .addCase(addData, (state, action) => {\n      const {kataData = null} = action;\n      // console.log('[*] KataData: push new data', kataData);\n      if (kataData) {\n        console.log(kataData);\n        state.kataData.push(kataData);\n      }\n    })\n    .addCase(reset, (state, action) => {\n      state.kataData = [];\n    })\n    .addCase(deleteOne, (state, action)=>{\n      if (state.kataData.length > 0) {\n        state.kataData.pop();\n      }\n    }).addCase(gameStatus, (state, action) => {\n      const {gameStatus} = action;\n      state.gameStatus = gameStatus;\n    }).addCase(gobackN, (state, action) => {\n      const {id = null} = action;\n      if (!id) {\n        console.log('[*] No id found, can not go back');\n        return;\n      }\n      state.gobackN = id;\n    });\n});\n\nexport default dataReducer;\n","import {configureStore} from '@reduxjs/toolkit';\nimport dataReducer from './reducer';\n\nexport default configureStore({\n  reducer: {\n      kataData: dataReducer,\n  },\n});\n","import react from 'react';\nimport helper from './helper';\n\nconst {createElement: h, Component} = react;\nconst {alpha} = helper;\n\nclass CoordX extends Component {\n  render() {\n    const {\n      style,\n      xs,\n      coordX = (i) => alpha[i] || alpha[alpha.length - 1],\n    } = this.props;\n\n    return h(\n      'div',\n      {\n        className: 'shudan-coordx',\n        style: Object.assign(\n          {\n            display: 'flex',\n            textAlign: 'center',\n          },\n          style,\n        ),\n      },\n\n      xs.map((i) =>\n        h(\n          'div',\n          {key: i, style: {width: '1em'}},\n          h('span', {style: {display: 'block'}}, coordX(i)),\n        ),\n      ),\n    );\n  }\n}\n\nclass CoordY extends Component {\n  render() {\n    const {style, height, ys, coordY = (i) => height - i} = this.props;\n\n    return h(\n      'div',\n      {\n        className: 'shudan-coordy',\n        style: Object.assign(\n          {\n            textAlign: 'center',\n          },\n          style,\n        ),\n      },\n\n      ys.map((i) =>\n        h(\n          'div',\n          {key: i, style: {height: '1em'}},\n          h('span', {style: {display: 'block'}}, coordY(i)),\n        ),\n      ),\n    );\n  }\n}\n\nexport default {CoordX, CoordY};\n","import react from 'react';\n\nconst {createElement: h, Component} = react;\n\nclass Grid extends Component {\n  shouldComponentUpdate(nextProps) {\n    return (\n      nextProps.vertexSize !== this.props.vertexSize ||\n      nextProps.width !== this.props.width ||\n      nextProps.height !== this.props.height ||\n      nextProps.xs.length !== this.props.xs.length ||\n      nextProps.ys.length !== this.props.ys.length ||\n      nextProps.xs[0] !== this.props.xs[0] ||\n      nextProps.ys[0] !== this.props.ys[0]\n    );\n  }\n\n  render() {\n    const {vertexSize, width, height, xs, ys, hoshis} = this.props;\n    const halfVertexSize = vertexSize / 2;\n    const fl = Math.floor;\n\n    return (\n      xs.length > 0 &&\n      ys.length > 0 &&\n      h(\n        'svg',\n        {\n          className: 'shudan-grid',\n          style: {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            zIndex: 0,\n          },\n        },\n\n        // Draw grid lines\n\n        ys.map((_, i) => {\n          const x = xs[0] === 0 ? halfVertexSize : 0;\n\n          return h('rect', {\n            key: `h${i}`,\n\n            className: 'shudan-gridline shudan-horizontal',\n            x: fl(x),\n            y: fl((2 * i + 1) * halfVertexSize),\n            width:\n              xs[xs.length - 1] === width - 1 ?\n                fl((2 * xs.length - 1) * halfVertexSize - x) :\n                fl(xs.length * vertexSize - x),\n            height: 1,\n          });\n        }),\n\n        xs.map((_, i) => {\n          const y = ys[0] === 0 ? halfVertexSize : 0;\n\n          return h('rect', {\n            key: `v${i}`,\n\n            className: 'shudan-gridline shudan-vertical',\n            x: fl((2 * i + 1) * halfVertexSize),\n            y: fl(y),\n            width: 1,\n            height:\n              ys[ys.length - 1] === height - 1 ?\n                fl((2 * ys.length - 1) * halfVertexSize - y) :\n                fl(ys.length * vertexSize - y),\n          });\n        }),\n\n        // Draw hoshi points\n\n        hoshis.map(([x, y]) => {\n          const i = xs.indexOf(x);\n          const j = ys.indexOf(y);\n          if (i < 0 || j < 0) return;\n\n          return h('circle', {\n            key: [x, y].join('-'),\n\n            className: 'shudan-hoshi',\n            cx: fl((2 * i + 1) * halfVertexSize) + 0.5,\n            cy: fl((2 * j + 1) * halfVertexSize) + 0.5,\n            r: '.1em',\n          });\n        }),\n      )\n    );\n  }\n}\n\nexport default Grid;\n\n","import react from 'react';\nimport helper from './helper';\nimport classnames from 'classnames';\nconst {createElement: h, Component} = react;\nconst {vertexEvents} = helper;\n\n\nconst absoluteStyle = (zIndex) => ({\n  position: 'absolute',\n  zIndex,\n});\n\nclass Vertex extends Component {\n  constructor(props) {\n    super(props);\n\n    for (const e of vertexEvents) {\n      this[`handle${e}`] = (evt) => {\n        const handler = this.props[`on${e}`] || (() => {});\n        handler(evt, this.props.position);\n      };\n    }\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return (\n      this.props.shift !== nextProps.shift ||\n      this.props.random !== nextProps.random ||\n      this.props.sign !== nextProps.sign ||\n      this.props.selected !== nextProps.selected ||\n      this.props.heat !== nextProps.heat ||\n      this.props.paint !== nextProps.paint ||\n      this.props.dimmed !== nextProps.dimmed ||\n      this.props.marker !== nextProps.marker ||\n      this.props.ghostStone !== nextProps.ghostStone ||\n      this.props.animate !== nextProps.animate\n    );\n  }\n\n  render() {\n    const {\n      position,\n      shift,\n      random,\n      sign,\n      heat,\n      paint,\n      dimmed,\n      marker,\n      ghostStone,\n      animate,\n      selected,\n      selectedLeft,\n      selectedRight,\n      selectedTop,\n      selectedBottom,\n    } = this.props;\n\n    const markerMarkup = (z) =>\n      !!marker &&\n      h('div', {\n        key: 'marker',\n        className: 'shudan-marker',\n        title: marker.label,\n        style: absoluteStyle(z),\n      });\n\n    return h(\n      'div',\n      Object.assign(\n        {\n          'data-x': position[0],\n          'data-y': position[1],\n\n          'style': {\n            position: 'relative',\n          },\n          'className': classnames(\n            'shudan-vertex',\n            `shudan-random_${random}`,\n            `shudan-sign_${sign}`,\n\n            {\n              [`shudan-shift_${shift}`]: !!shift,\n              [`shudan-heat_${!!heat && heat.strength}`]: !!heat,\n              [`shudan-paint_${paint > 0 ? 1 : -1}`]: !!paint,\n              'shudan-dimmed': dimmed,\n              'shudan-selected': selected,\n              'shudan-selectedleft': selectedLeft,\n              'shudan-selectedright': selectedRight,\n              'shudan-selectedtop': selectedTop,\n              'shudan-selectedbottom': selectedBottom,\n              'shudan-animate': animate,\n            },\n\n            marker && marker.type && `shudan-marker_${marker.type}`,\n            marker &&\n              marker.type === 'label' &&\n              marker.label &&\n              (marker.label.includes('\\n') || marker.label.length >= 3) &&\n              `shudan-smalllabel`,\n\n            ghostStone && `shudan-ghost_${ghostStone.sign}`,\n            ghostStone && ghostStone.type && `shudan-ghost_${ghostStone.type}`,\n            ghostStone && ghostStone.faint && `shudan-ghost_faint`,\n          ),\n        },\n        ...vertexEvents.map((eventName) => ({\n          [`on${eventName}`]: this[`handle${eventName}`],\n        })),\n      ),\n\n      !sign && markerMarkup(0),\n      !sign &&\n        !!ghostStone &&\n        h('div', {\n          key: 'ghost',\n          className: 'shudan-ghost',\n          style: absoluteStyle(1),\n        }),\n\n      h(\n        'div',\n        {key: 'stone', className: 'shudan-stone', style: absoluteStyle(2)},\n        !!sign &&\n          h('div', {\n            key: 'shadow',\n            className: 'shudan-shadow',\n            style: absoluteStyle(),\n          }),\n        !!sign &&\n          h(\n            'div',\n            {\n              key: 'inner',\n              className: classnames(\n                'shudan-inner',\n                'shudan-stone-image',\n                `shudan-random_${random}`,\n                `shudan-sign_${sign}`,\n              ),\n              style: absoluteStyle(),\n            },\n            sign,\n          ),\n\n        !!sign && markerMarkup(),\n      ),\n\n      !!paint &&\n        h('div', {\n          key: 'paint',\n          className: 'shudan-paint',\n          style: {\n            ...absoluteStyle(3),\n            opacity: Math.abs(paint || 0) * 0.5,\n          },\n        }),\n\n      !!selected &&\n        h('div', {\n          key: 'selection',\n          className: 'shudan-selection',\n          style: absoluteStyle(4),\n        }),\n\n      h('div', {\n        key: 'heat',\n        className: 'shudan-heat',\n        style: absoluteStyle(5),\n      }),\n      !!heat &&\n        h(\n          'div',\n          {\n            key: 'heatlabel',\n            className: 'shudan-heatlabel',\n            style: absoluteStyle(6),\n          },\n          heat.text && heat.text.toString(),\n        ),\n    );\n  }\n}\n\n// module.exports = Vertex;\nexport default Vertex;\n","import react from 'react';\nimport helper from './helper';\n\nconst {createElement: h, Component} = react;\nconst {vertexEquals} = helper;\n\nclass Line extends Component {\n  shouldComponentUpdate(nextProps) {\n    const {v1, v2, type, vertexSize} = this.props;\n\n    return (\n      type !== nextProps.type ||\n      vertexSize !== nextProps.vertexSize ||\n      !vertexEquals(v1, nextProps.v1) ||\n      !vertexEquals(v2, nextProps.v2)\n    );\n  }\n\n  render() {\n    const {v1, v2, type = 'line', vertexSize} = this.props;\n    if (vertexEquals(v1, v2)) return;\n\n    const [pos1, pos2] = [v1, v2].map((v) => v.map((x) => x * vertexSize));\n    const [dx, dy] = pos1.map((x, i) => pos2[i] - x);\n    const [left, top] = pos1.map((x, i) => (x + pos2[i] + vertexSize) / 2);\n\n    const angle = (Math.atan2(dy, dx) * 180) / Math.PI;\n    const length = Math.sqrt(dx * dx + dy * dy);\n\n    return h('div', {\n      className: `shudan-${type}`,\n      style: {\n        position: 'absolute',\n        left,\n        top,\n        margin: 0,\n        width: length,\n        transform: `translateX(${-length / 2}px) rotate(${angle}deg)`,\n      },\n    });\n  }\n}\n\nexport default Line;\n// module.exports = Line;\n","/* eslint-disable react/no-direct-mutation-state */\nimport react from 'react';\nimport classnames from 'classnames';\n\nimport helper from './helper';\nimport Coord from './Coord';\nimport Grid from './Grid';\nimport Vertex from './Vertex';\nimport Line from './Line';\n\nconst {createElement: h, Component} = react;\nconst {CoordX, CoordY} = Coord;\nclass Goban extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {};\n  }\n\n  componentDidUpdate() {\n    if (\n      this.props.animateStonePlacement &&\n      !this.state.clearAnimatedVerticesHandler &&\n      this.state.animatedVertices.length > 0\n    ) {\n      // Handle stone animation\n\n      for (const [x, y] of this.state.animatedVertices) {\n        this.state.shiftMap[y][x] = helper.random(7) + 1;\n        helper.readjustShifts(this.state.shiftMap, [x, y]);\n      }\n\n      this.setState({shiftMap: this.state.shiftMap});\n\n      // Clear animation classes\n\n      this.setState({\n        clearAnimatedVerticesHandler: setTimeout(() => {\n          this.setState({\n            animatedVertices: [],\n            clearAnimatedVerticesHandler: null,\n          });\n        }, this.props.animationDuration || 200),\n      });\n    }\n  }\n\n  render() {\n    const {\n      width,\n      height,\n      rangeX,\n      rangeY,\n      xs,\n      ys,\n      hoshis,\n      shiftMap,\n      randomMap,\n    } = this.state;\n\n    const {\n      innerProps = {},\n      vertexSize = 24,\n      coordX,\n      coordY,\n      busy,\n      signMap,\n      paintMap,\n      heatMap,\n      markerMap,\n      ghostStoneMap,\n      fuzzyStonePlacement = false,\n      showCoordinates = false,\n      lines = [],\n      selectedVertices = [],\n      dimmedVertices = [],\n    } = this.props;\n\n    const animatedVertices = [].concat(\n      ...this.state.animatedVertices.map(helper.neighborhood),\n    );\n\n    return h(\n      'div',\n      Object.assign({}, innerProps, {\n        id: this.props.id,\n        className:\n          classnames('shudan-goban', 'shudan-goban-image', {\n            'shudan-busy': busy,\n            'shudan-coordinates': showCoordinates,\n          }) +\n          ' ' +\n          (this.props.class || this.props.className || ''),\n\n        style: Object.assign(\n          {\n            display: 'inline-grid',\n            gridTemplateRows: showCoordinates ? '1em 1fr 1em' : '1fr',\n            gridTemplateColumns: showCoordinates ? '1em 1fr 1em' : '1fr',\n            fontSize: vertexSize,\n            lineHeight: '1em',\n          },\n          this.props.style || {},\n        ),\n      }),\n\n      showCoordinates &&\n        h(CoordX, {xs, style: {gridRow: '1', gridColumn: '2'}, coordX}),\n      showCoordinates &&\n        h(CoordY, {height, ys, style: {gridRow: '2', gridColumn: '1'}, coordY}),\n\n      h(\n        'div',\n        {\n          className: 'shudan-content',\n          style: {\n            position: 'relative',\n            width: `${xs.length}em`,\n            height: `${ys.length}em`,\n            gridRow: showCoordinates ? '2' : '1',\n            gridColumn: showCoordinates ? '2' : '1',\n          },\n        },\n\n        h(Grid, {\n          vertexSize,\n          width,\n          height,\n          xs,\n          ys,\n          hoshis,\n        }),\n\n        h(\n          'div',\n          {\n            className: 'shudan-vertices',\n            style: {\n              display: 'grid',\n              gridTemplateColumns: `repeat(${xs.length}, 1em)`,\n              gridTemplateRows: `repeat(${ys.length}, 1em)`,\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              zIndex: 1,\n            },\n          },\n\n          ys.map((y) =>\n            xs.map((x) => {\n              const equalsVertex = (v) => helper.vertexEquals(v, [x, y]);\n              const selected = selectedVertices.some(equalsVertex);\n\n              return h(\n                Vertex,\n                Object.assign(\n                  {\n                    key: [x, y].join('-'),\n                    position: [x, y],\n\n                    shift: fuzzyStonePlacement ?\n                      shiftMap && shiftMap[y] && shiftMap[y][x] :\n                      0,\n                    random: randomMap && randomMap[y] && randomMap[y][x],\n                    sign: signMap && signMap[y] && signMap[y][x],\n\n                    heat: heatMap && heatMap[y] && heatMap[y][x],\n                    paint: paintMap && paintMap[y] && paintMap[y][x],\n                    marker: markerMap && markerMap[y] && markerMap[y][x],\n                    ghostStone:\n                      ghostStoneMap && ghostStoneMap[y] && ghostStoneMap[y][x],\n                    dimmed: dimmedVertices.some(equalsVertex),\n                    animate: animatedVertices.some(equalsVertex),\n\n                    selected,\n                    selectedLeft:\n                      selected &&\n                      selectedVertices.some((v) =>\n                        helper.vertexEquals(v, [x - 1, y]),\n                      ),\n                    selectedRight:\n                      selected &&\n                      selectedVertices.some((v) =>\n                        helper.vertexEquals(v, [x + 1, y]),\n                      ),\n                    selectedTop:\n                      selected &&\n                      selectedVertices.some((v) =>\n                        helper.vertexEquals(v, [x, y - 1]),\n                      ),\n                    selectedBottom:\n                      selected &&\n                      selectedVertices.some((v) =>\n                        helper.vertexEquals(v, [x, y + 1]),\n                      ),\n                  },\n                  ...helper.vertexEvents.map((e) => ({\n                    [`on${e}`]: this.props[`onVertex${e}`],\n                  })),\n                ),\n              );\n            }),\n          ),\n        ),\n\n        h(\n          'div',\n          {\n            className: 'shudan-lines',\n            style: {\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              overflow: 'hidden',\n              pointerEvents: 'none',\n              zIndex: 2,\n            },\n          },\n\n          h(\n            'div',\n            {\n              style: {\n                position: 'absolute',\n                top: `-${rangeY[0]}em`,\n                left: `-${rangeX[0]}em`,\n                width: `${width}em`,\n                height: `${height}em`,\n              },\n            },\n\n            lines.map(({v1, v2, type}, i) =>\n              h(Line, {key: i, v1, v2, type, vertexSize}),\n            ),\n          ),\n        ),\n      ),\n\n      showCoordinates &&\n        h(CoordY, {height, ys, style: {gridRow: '2', gridColumn: '3'}, coordY}),\n      showCoordinates &&\n        h(CoordX, {xs, style: {gridRow: '3', gridColumn: '2'}, coordX}),\n    );\n  }\n}\n\nGoban.getDerivedStateFromProps = function(props, state) {\n  const {signMap = [], rangeX = [0, Infinity], rangeY = [0, Infinity]} = props;\n\n  const width = signMap.length === 0 ? 0 : signMap[0].length;\n  const height = signMap.length;\n\n  if (state.width === width && state.height === height) {\n    let animatedVertices = state.animatedVertices;\n\n    if (\n      props.animateStonePlacement &&\n      props.fuzzyStonePlacement &&\n      state.clearAnimatedVerticesHandler == null\n    ) {\n      animatedVertices = helper.diffSignMap(state.signMap, signMap);\n    }\n\n    const result = {\n      signMap,\n      animatedVertices,\n    };\n\n    if (\n      !helper.vertexEquals(state.rangeX, rangeX) ||\n      !helper.vertexEquals(state.rangeY, rangeY)\n    ) {\n      // Range changed\n\n      Object.assign(result, {\n        rangeX,\n        rangeY,\n        xs: helper.range(width).slice(rangeX[0], rangeX[1] + 1),\n        ys: helper.range(height).slice(rangeY[0], rangeY[1] + 1),\n      });\n    }\n\n    return result;\n  }\n\n  // Board size changed\n\n  return {\n    signMap,\n    width,\n    height,\n    rangeX,\n    rangeY,\n    animatedVertices: [],\n    clearAnimatedVerticesHandler: null,\n    xs: helper.range(width).slice(rangeX[0], rangeX[1] + 1),\n    ys: helper.range(height).slice(rangeY[0], rangeY[1] + 1),\n    hoshis: helper.getHoshis(width, height),\n    shiftMap: helper.readjustShifts(\n      signMap.map((row) => row.map((_) => helper.random(8))),\n    ),\n    randomMap: signMap.map((row) => row.map((_) => helper.random(4))),\n  };\n};\n\n// module.exports = Goban;\nexport default Goban;\n","// 以localStorage的形式存储数据\nconst set = (key, value) => {\n  if (!key) {\n    // 入参非法\n    return false;\n  }\n  if (typeof localStorage !== 'object') {\n    // 不支持localstorage\n    return false;\n  }\n  try {\n    if (Array.isArray(value) || typeof value === 'object') {\n      value = JSON.stringify(value);\n    }\n    localStorage.setItem(key, value);\n  } catch (e) {\n  console.log('[Storage] 存储时发生错误', e);\n    return false;\n  }\n  return true;\n};\n\nconst get = (key) => {\n  if (!key) {\n    return false;\n  }\n  if (typeof localStorage !== 'object') {\n    // 不支持localstorage\n    return false;\n  }\n  return localStorage.getItem(key);\n};\n\nexport {\n  set,\n  get,\n};\n","const {\n  ControllerStateTracker,\n  Controller,\n  Command,\n  Response,\n} = require('@sabaki/gtp');\n\nimport {gtpPath} from './constant';\n\n/*\n  这个文件提供进行gtp通信时可能会使用的一些方法\n------------------------------------常规知识------------------------------------\n  围棋棋盘大小一般为19*19,横向A-T,竖向1-19,通过字母数字组合可确定棋盘上一个位置,如D5\n  gtp命令的格式为{id:int, name: '', arg: []},gtp命令和字符串可以相互转换\n  gtp字符串的格式为[id] name [arg],其中id和arg可能不存在\n  成功的gtp回复以=开头,失败的gtp协议以?开头\n------------------------------------gtp命令------------------------------------\n  常用的GTP命令有: boardsize,clear_board,play,undo,genmove,showboard,quit\n  比赛时间相关的命令: time_settings,time_left\n  查询比赛状态: final_score,final_status_list\n  文件操作: load_sgf\n\n--------------------------------gtp通讯交互样例----------------------------------\n  >> 1 boardsize 7   #请求创建棋盘,大小为7*7#\n  >> =1              #创建成功#\n  >> 2 clear_board   #清空棋盘#\n  >> =2              #执行成功#\n  >> 3 play black D5 #黑子下棋于D5#\n  >> =3\n  >> 4 genmove white #请求电脑下白棋#\n  >> =4 C3           #服务端回复电脑下棋位置#\n  >> 5 play black C3 #尝试向C3下黑子#\n  >> ?5 illegal move #非法操作,拒绝,回复不以=开头#\n  >> 6 play black E3 #黑子下棋于E3#\n  >> 7 showboard     #请求展示棋盘#\n  >> =7\n       A B C D E F G\n     7 . . . . . . . 7\n     6 . . . . . . . 6\n     5 . . + X + . . 5\n     4 . . . + . . . 4\n     3 . . O . X . . 3\n     2 . . . . . . . 2     WHITE (O) has captured 0 stones\n     1 . . . . . . . 1     BLACK (X) has captured 0 stones\n       A B C D E F G\n  >> 8 quit          #结束通讯#\n  >> =8\n----------------------------------------------------------------------------\n  更详细的GTP-2协议见https://www.lysator.liu.se/~gunnar/gtp/gtp2-spec-draft2.pdf\n */\n\n// 提供gtp通讯的一些方法\nexport default class GtpSocket {\n  constructor(path = gtpPath) {\n    this.socket = new Controller(gtpPath, ['--gtp', '--noponder']);\n    this.socket.start();\n    this.tracker = new ControllerStateTracker(this.socket);\n  }\n  /**\n   * 使用初始化的GTP socket发送命令\n   * @param  {object} gtpCommand gtp指令 {id:1, name: '', arg: []}\n   * @param  {object} option     额外配置 {stringifyRes: false}\n   * @return {object} res        gtp response{id:1, content:'', error:false}\n   */\n  async send(gtpCommand, option={}) {\n    const res = await this.socket.sendCommand(gtpCommand);\n    if (option.stringifyRes) {\n      res = Response.toString(res);\n    }\n    return res;\n  }\n  // 停止GTP socket\n  async stop() {\n    try {\n      await this.socket.stop();\n    } catch (e) {\n      return new Error(e);\n    }\n    return true;\n  }\n  async start(path) {\n    if (!path) {\n      return false;\n    }\n    this.socket = new Controller(gtpPath, ['--gtp', '--noponder']);\n    return true;\n  }\n  /**\n   * 获取服务器状态\n   * @return {object} 服务器状态\n   */\n  async getEngineState() {\n    const state = await this.tracker.state();\n    return state;\n  }\n  async isBusy() {\n    const state = await this.tracker.syncing();\n    return state;\n  }\n  async isRightCommand(name) {\n    const res = await this.tracker.knowsCommand(name);\n    return res;\n  }\n};\n\n/**\n * 创建一次快捷gtp通讯\n * @param  {object} gtpParam   gtp command\n * @param  {object} option     额外配置 {stringifyRes: false}\n * @return {object} res        gtp Response\n */\nexport async function gtpFetch(gtpParam={}, option={}) {\n  const leela = new Controller(gtpPath, ['--gtp', '--noponder']);\n  leela.start();\n  let res = await leela.sendCommand(gtpParam);\n  if (option.stringifyRes) {\n    res = Response.toString(res);\n  }\n  await leela.stop();\n  return res;\n}\n\n/**\n * gtp指令转成sting\n * @param  {object} command gtp指令 {id:1, name: '', arg: []}\n * @return {string} res     gtp指令转换成的string\n */\nexport function gtpStringify(command) {\n  return Command.toString(command);\n};\n\n/**\n * 把字符串转成gtp指令\n * @param  {string} gtpString gtp指令字符串\n * @return {object} res       gtp指令 {id:1, name: '', arg: []}\n */\nexport function gtpParse(gtpString) {\n  return Command.fromString(gtpString);\n};\n","import Cookies from 'js-cookie';\nimport {gtpParse} from '../util/gtp';\n// import {gtpPath, EmptyMap} from '../util/constant';\n// const compress = require('brotli/compress');\nimport {str2ab, get10TimeStamp, windowModalComp} from '../util/helper';\nconst decompress = require('brotli/decompress');\n\nlet socket = null;\nlet commonFn = {windowModalComp, str2ab};\nlet sendTimeout = null;\nconst gtpTimeout = 10000; // 1s超时时间\n// 检查battle局部的socket和入参ws,如果没有,就赋值\nconst checkSocket = function(ws) {\n  if (!socket) {\n      socket = ws;\n  }\n  if (!ws) {\n      ws = socket;\n  }\n  if (!ws && !socket) {\n      console.log('[WARN] No socket instance!!!', ws);\n      const handleFn = () => {\n        location.reload();\n      };\n      commonFn.windowModalComp('提示', '网络连接异常 Code:nows', handleFn, ()=>{}, '重试');\n      return;\n  }\n  if (ws.readyState !== 1) {\n    console.log('[WARN] websocket链接状态异常', ws.readyState);\n    const handleFn = () => {\n      location.reload();\n    };\n    commonFn && commonFn.windowModalComp('提示', '网络连接异常 Code:ws' + ws.readyState, handleFn, ()=>{}, '刷新页面');\n    return;\n  }\n  return ws;\n};\n\n// 清空棋盘,结束对局\nconst finishBoard = () => {\n  if (!commonFn || !socket) {\n    return;\n  }\n  commonFn.clearBoard(commonFn.board, commonFn.setBoard, commonFn.gameStatus, commonFn.setGameStatus, commonFn.setStartGame);\n};\n\n// 生成记录玩家下棋的GTP命令\nconst genPlayMessage = (code, sign, pos) => {\n    const color = (sign === -1 ? 'W' : 'B');\n    const x = pos[0];\n    const y = pos[1];\n    const coordX = 'ABCDEFGHJKLMNOPQRST';\n    const newPos = `${coordX[x]}${19 - y}`;\n    const gtpMessage = `${code} ${color} ${newPos}`;\n    return gtpMessage;\n};\n\n/**\n * 从一个sgf棋谱初始化一个对局\n * @param {Array} nodeList sgf棋谱的每一步位置\n * @param {WebSocket} ws   websocket链接\n */\nconst initBoardFromMap = (nodeList, ws) => {\n  ws = checkSocket(ws);\n  if (!nodeList) {\n    // 棋谱获取失败\n    commonFn.windowModalComp('提示', '棋谱获取失败');\n    return;\n  }\n  commonFn.setLoading(true);\n  if (nodeList.length === 0) {\n    commonFn.initBoardStatus = true;\n    sendCommonGtp(null, 'name'); // 开始初始化棋盘\n  }\n  let board = commonFn.board;\n  const commondList = [];\n  nodeList.forEach((item) => {\n    let sign = 0;\n    if (item.B) {\n      sign = -1;\n      commondList.push(genPlayMessage('play', sign, item.B));\n      board = board.makeMove(sign, item.B);\n    } else if (item.W) {\n      sign = 1;\n      commondList.push(genPlayMessage('play', sign, item.W));\n      board = board.makeMove(sign, item.W);\n    }\n    // console.log('[*] 棋子:', item.B, item.W);\n  });\n  commonFn.setBoard(board);\n  commonFn.board = board;\n  commonFn.chessManual = commondList;\n  commonFn.playChessManual = true;\n  commonFn.initBoardStatus = true;\n  sendCommonGtp(null, 'name'); // 开始初始化棋盘\n};\n\n/**\n * 处理ack成功但服务器觉得有问题的gtp命令\n * @param {Object} jsonData  ws返回json数据\n * @param {Object} shareData 共享数据,可以操作组件状态\n * @return {Boolean} 是否发送新的ws命令\n */\nconst handleWrongGtp = (jsonData, shareData) => {\n    const {setLoading, showAlert} = shareData;\n    const {msg} = jsonData.body;\n    const serverGtpObj = gtpParse(msg);\n    // 如果玩家下棋非法,则更新状态并返回\n    console.log('[*] 服务器返回gtp信息', serverGtpObj);\n    if (serverGtpObj.args[0] === 'illegal') {\n        showAlert('此处不能落子');\n        return false;\n    }\n};\n\n/**\n * 处理初始化棋盘的一连串逻辑,根据上次gtp命令发送下一个gtp命令\n * 如果不属于初始化棋盘过程,则什么都不做\n * @param  {Object} shareData 共享数据,可以操作组件状态\n * @return {Boolean} 是否执行了新的发送命令 true为是\n */\nconst initBoard = (shareData) => {\n    /*\n      开局需要的参数是\n      clear_board\n      clear_cache\n      komi 7.5\n      boardsize 19\n      time_setting 0 3 1\n      kata-set-rules japanese\n      kata-set-param playoutDoublingAdvantage 0.0\n    */\n   if (!shareData.initBoardStatus) {\n     // 未进入初始化棋盘阶段\n     return false;\n   }\n    const initGameGtpSequence = ['name', 'stop', 'clear_board', 'clear_cache', 'komi 7.5', 'boardsize 19', 'time_settings 0 3 1', 'kata-set-rules japanese', 'kata-set-param playoutDoublingAdvantage 0.0'];\n    const gtpHistory = Cookies.get('gtpHistory');\n    const lastGtp = gtpHistory;\n    let isInitGame = false;\n    let nextStepGtp = null;\n    for (const seq of initGameGtpSequence) {\n        if (isInitGame) {\n            // 记录接下来第一个命令, 作为initGame的下一步骤\n            nextStepGtp = seq;\n            break;\n        }\n        if (!isInitGame && lastGtp === seq) {\n            isInitGame = true;\n        }\n    }\n    // 执行下一步初始化棋盘的命令\n    if (isInitGame && nextStepGtp) {\n        sendCommonGtp(null, nextStepGtp);\n        return true;\n    } else if (isInitGame && !nextStepGtp) {\n      // 退出初始化棋盘阶段\n      shareData.initBoardStatus = false; // 标识初始化状态结束\n      shareData.setStartGame(true); // 标识开启游戏\n      // 如果是放置棋谱阶段,应该调用setMapBoard来开始放置棋子\n      if (shareData.playChessManual) {\n        setMapBoard();\n        return true;\n      }\n      // 正常对弈模式, 初始化完成, 发送第一步下棋命令\n      const playOperation = JSON.parse(Cookies.get('playOperation') || {});\n      const {sign, pos} = playOperation;\n      sendCommonGtp(null, genPlayMessage('play', sign, pos));\n      return true;\n    }\n    return false;\n};\n\nconst parseWinAndLose = (jsonData, shareData) => {\n  const {msg} = jsonData.body;\n  const gtpObj = gtpParse(msg);\n  if (gtpObj && gtpObj.name === 'resign') {\n    // AI已投降\n    // [TODO] 保存对局sgf文件,转到分析对局\n    finishBoard();\n    shareData.windowModalComp('提示', 'AI已投降!');\n  }\n};\n\n/**\n * 如果ws回复时上一条gtp是同步用户下棋操作,那么发送请求AI下棋的gtp命令\n * @param  {Object} jsonData  服务端返回的json数据\n * @param  {Object} shareData 共享数据,可以操作组件状态\n * @return {Boolean} 是否执行了新的发送命令 true为是\n */\nconst getAIPlay = (jsonData, shareData) => {\n    const {setLoading, showAlert} = shareData;\n    const {msg} = jsonData.body;\n    const gtpHistory = Cookies.get('gtpHistory');\n    const gtpObj = gtpParse(gtpHistory);\n    const serverGtpObj = gtpParse(msg);\n    // 如果处于放置棋谱模式,则不请求下棋, 而是继续放置棋子\n    if (shareData.playChessManual) {\n      setMapBoard();\n      return true;\n    }\n    if (gtpObj && (gtpObj.name === 'play')) {\n        // 上个ws命令是玩家下棋, 执行请求AI下棋逻辑\n        const sign = gtpObj.args[0];\n        // 请求AI下棋, sign与玩家用的相反\n        sendCommonGtp(null, `genmove ${sign === 'B' ? 'W' : 'B'}`);\n        return true;\n    }\n    return false;\n};\n\n/**\n * 如果ws回复时上一条gtp是请求AI下棋,那么解析AI返回的下棋数据\n * @param  {Object} data  服务端返回的json数据\n * @param  {Object} shareData 共享数据,可以操作组件状态\n * @return {Boolean} 是否执行了新的发送命令 true为是\n */\nconst parseAIResult = (data, shareData) => {\n    const {board, setBoard} = shareData;\n    const {gameStatus} = shareData;\n    const {addNewNode} = shareData;\n    const gtpHistory = Cookies.get('gtpHistory');\n    const gtpObj = gtpParse(gtpHistory);\n    const gameAnalysis = String(Cookies.get('gameAnalysis'));\n    if (gtpObj && gtpObj.name === 'genmove') {\n        // 解析服务端返回的数据\n        const {msg} = data.body;\n        const posRaw = msg.split(' ')[1];\n        const xCode = posRaw[0];\n        const yCode = posRaw.substring(1, posRaw.length);\n        const coordX = 'ABCDEFGHJKLMNOPQRST'.split('');\n        let x;\n        for (let i = 0; i < coordX.length; i++) {\n            if (coordX[i] === xCode) {\n                x = i;\n            }\n        }\n        const y = 19 - parseInt(yCode);\n        const newPos = [x, y];\n        // console.log('[*]服务端返回AI下棋结果', msg, newPos, gtpObj.args);\n        const signChar = gtpObj.args[0];\n        const sign = signChar === 'B' ? 1 : -1;\n        const newBoard = board.makeMove(sign, newPos);\n        // 更新Tree记录\n        // console.log('[*] gameStatus in pareATResult: ', gameStatus);\n        addNewNode(sign, [x, y], gameStatus);\n        shareData.dispatch({type: 'kataData/gameStatus', gameStatus: JSON.stringify({\n          ...gameStatus.currentGameTree.root,\n        })});\n        // 更新棋盘\n        setBoard(newBoard);\n        shareData.board = newBoard;\n        if (signChar === 'B') {\n          // AI下黑棋,说明AI帮玩家下了一步,继续请求AI下棋\n          // [TODO] 如果更换玩家棋子颜色,这里要更改\n          sendCommonGtp(null, 'genmove W');\n          return true;\n        }\n    }\n    // 不会发起新的ws请求, 进行下一步处理\n    return false;\n};\n\n// 请求AI下一步棋\nconst askHelp = () => {\n  if (!commonFn) {\n    return false;\n  }\n  if (!commonFn.gameStatus) {\n    // 游戏未开始\n    return false;\n  }\n  // 请求AI为玩家下棋\n  commonFn.setLoading(true);\n  sendCommonGtp(null, 'genmove B');\n  return true;\n};\n\n/**\n * 分析kata-analyze的回复\n * @param {*} jsonData  ws返回的数据\n * @param {*} shareData 共享对象\n * @return {Boolean}    返回值\n */\nconst parseAnalysis = (jsonData, shareData) => {\n  const msg = jsonData.body.msg;\n  const gtpInfo = gtpParse(msg);\n  if (gtpInfo && gtpInfo.name === 'info') {\n    const infoData = gtpInfo.args;\n    let indicator = '';\n    const indicatorList = ['info', 'move', 'visits', 'winrate', 'scoreMean', 'scoreStdev', 'scoreLead', 'scoreSelfplay', 'prior', 'lcb', 'utilityLcb', 'order', 'pv'];\n    const infoList = [];\n    let eachInfo = {pv: []};\n    infoData.forEach((item) => {\n      let isIndicator = false;\n      indicatorList.forEach((ind) => {\n        if (isIndicator) {\n            return;\n        }\n        if (item === ind) {\n          isIndicator = true;\n          indicator = ind;\n        }\n      });\n      if (!isIndicator || indicator === 'info') {\n        // 当前为数据, 根据上一个indicator来操作数据\n        if (indicator === 'info') {\n          // 标志着上一个解析结束,新的解析开始, 如果未缺失关键信息, 则\n          if (eachInfo.move) {\n            infoList.push(eachInfo);\n          }\n          // 清空eachInfo, 以供后续添加\n          eachInfo = {pv: []};\n        } else if (indicator === 'pv') {\n          // 处理pv的数据\n          eachInfo.pv.push(item);\n        } else {\n          eachInfo[indicator] = item;\n        }\n      }\n    });\n    // push最后一项数据, 没有info结尾,需要手动push\n    infoList.push(eachInfo);\n    // console.log('[*] 同步处理完的数据:', infoList);\n    shareData.dispatch({type: 'kataData/addData', kataData: infoList});\n    // shareData.kataData && shareData.kataData.push(infoList);\n    return false;\n  }\n  return false;\n};\n\n// 向服务器通讯直到初始化完毕整个棋谱\nconst setMapBoard = () => {\n  if (!commonFn) {\n    return;\n  }\n  if (commonFn.playChessManual && commonFn.chessManual.length > 0) {\n    // 发送放置棋子的命令\n    const cmd = commonFn.chessManual.shift();\n    sendCommonGtp(null, cmd);\n    return;\n  }\n  // 放置完成\n  commonFn.setLoading(false);\n  commonFn.playChessManual = false;\n};\n\n// 开启或关闭kata分析\nconst kataAnalyze = (ws, gameAnalysis) => {\n  if (!commonFn) {\n    return false;\n  }\n  // if (!commonFn.startGame) {\n  //   commonFn.windowModalComp('提示', '需要先进行对弈才能开启分析.');\n  //   return false;\n  // }\n  if (!gameAnalysis) {\n    sendCommonGtp(ws, 'kata-analyze 1000');\n  } else {\n    // 关闭kata-analyze\n    sendCommonGtp(ws, 'kata-analyze');\n  }\n  return !gameAnalysis;\n};\n\n/**\n * 发送ws消息, 初始化对局\n * @param {WebSocket} ws       websocket实例\n * @param {String}    msg      GTP命令\n */\nconst sendCommonGtp = (ws, msg) => {\n    ws = checkSocket(ws);\n    if (!ws) {\n      // checkSocket里有弹窗提醒\n      return;\n    }\n    // http://47.92.159.180:7070/ai/\n    const aiId = parseInt(Cookies.get('aiId')) || 4;\n\n    Cookies.set('aiId', aiId);\n    const userId = Cookies.get('userId');\n    const userName = Cookies.get('userName');\n    const gtpId = (msg === 'name') ? 0 : parseInt(Cookies.get('gtpId')); // 如果是name的话则重置gtpId为0\n    const jsonData = {\n        'ver': 1,\n        'op': 2,\n        'seq': get10TimeStamp(),\n        'body': {\n            // 'fromUserId': userId, // 发消息的用户id\n            // 'fromUserName': userName, // 发消息的用户名\n            'toUserId': aiId, // 收到消息的人\n            // 'toUserName': '',\n            'createTime': get10TimeStamp(),\n            'msg': `${gtpId} ${msg}`,\n            'opMethod': 2,\n        },\n    };\n    console.log('[WebSocket] Send: ', jsonData.body.msg, jsonData);\n    // [TODO] str转blob,压缩后发送\n    // const compressData = compress(str2ab(JSON.stringify(jsonData)), {\n    //   mode: 0, // 0 = generic, 1 = text, 2 = font (WOFF2)\n    //   quality: 5, // 0 - 11\n    //   lgwin: 0, // window size\n    // });\n    // console.log('[WebSocket] compress', compressData);\n    // ws.send(compressData);\n    Cookies.set('gtpHistory', msg);\n    Cookies.set('gtpId', gtpId + 1);\n    ws.send(JSON.stringify(jsonData));\n    sendTimeout = setTimeout(()=>{\n      const handleFn = () => {\n        location.reload();\n      };\n      commonFn.windowModalComp('提示', '连接超时', handleFn, () => {}, '刷新');\n    }, gtpTimeout);\n};\n\n/**\n * 发送ws消息,记录玩家下棋并请求ai下棋\n * @param {Object} data       ws data\n */\nconst aiPlay = (data) => {\n    const {sign, pos} = data;\n    // 生成玩家下棋的gtp指令\n    const gtpMessage = genPlayMessage('play', sign, pos);\n    sendCommonGtp(null, gtpMessage);\n};\n\nfunction defineMessage(shareData) {\n    if (!shareData.setBoard || !shareData.board || !shareData.setLoading) {\n        console.log('[Error] 没有棋盘回调函数');\n        return;\n    }\n    // 存储shareData用于使用common function\n    commonFn = shareData;\n    return (event) => {\n        const ackGtpId = parseInt(Cookies.get('gtpId')) - 1; // 确认上一个gpt命令的id\n        clearTimeout(sendTimeout);\n        const blobData = event.data;\n        // 通过文件流读取数据\n        const reader = new FileReader();\n        reader.readAsArrayBuffer(blobData);\n        reader.addEventListener('loadend', () => {\n          if (!reader || !reader.result) {\n              // blob读取异常\n              return;\n          }\n          try {\n            const unit8data = decompress(new Uint8Array(reader.result));\n            const data = String.fromCharCode.apply(null, unit8data);\n            // 解析\n            const jsonData = JSON.parse(data);\n            console.log('[WebSocket] Received Message: ', jsonData);\n            if (jsonData && jsonData.body) {\n                const gtpMessage = jsonData.body.msg;\n                if (gtpMessage.split(' ')[0] === `=${ackGtpId}`) {\n                    // Ack成功, 按照回复内容处理后续\n                    // 是否需要初始化棋盘, 如果需要则不再做其他判断\n                    const step1 = initBoard(shareData);\n                    if (step1) {\n                        // 初始化没有结束,不应该解锁棋盘\n                        return;\n                    }\n                    // 是否是胜负判断\n                    const stepWin = parseWinAndLose(jsonData, shareData);\n                    if (stepWin) {\n                      return;\n                    }\n                    // 是否需要请求AI下棋\n                    const step2 = getAIPlay(jsonData, shareData);\n                    if (step2) {\n                        return;\n                    }\n                    const step3 = parseAIResult(jsonData, shareData);\n                    // 执行ws回调完毕,设置loading为false\n                    // if (step3) {\n                    //   return;\n                    // }\n                    shareData.setLoading(false);\n                } else if (gtpMessage.split(' ')[0] === `?${ackGtpId}`) {\n                    // Ack成功, 但服务器对发送命令有疑问\n                    handleWrongGtp(jsonData, shareData);\n                    shareData.setLoading(false);\n                } else {\n                    // 其他情况\n                    if (gtpMessage.split(' ')[0] === 'offline' || gtpMessage.indexOf('offline')>0) {\n                      // AI处于离线状态,需要选择新的AI\n                      shareData.setLoading(false);\n                      shareData.showAlert('AI不可用,请选择对战AI');\n                      // 清空棋盘, 重置gtp通讯\n                      shareData.clearBoard(shareData.board, shareData.setBoard, shareData.gameStatus, shareData.setGameStatus, shareData.setStartGame);\n                      return;\n                    } else\n                    if (gtpMessage.split(' ')[0] === 'info') {\n                      parseAnalysis(jsonData, shareData);\n                      shareData.setLoading(false);\n                      return;\n                    }\n                    // 账号欠费\n                    if (gtpMessage.indexOf('needRecharge')!=-1) {\n                      shareData.setLoading(false);\n                      shareData.showAlert('账号欠费,请充值');\n                      shareData.clearBoard(shareData.board, shareData.setBoard, shareData.gameStatus, shareData.setGameStatus, shareData.setStartGame);\n                      return;\n                    }\n                    console.log('[*] GTP Extra Reply', gtpMessage);\n                    // [TODO] 重发Gtp命令, 多次重复后提示连接断开\n                }\n            }\n          } catch (e) {\n            shareData.setLoading(false);\n            console.log('[Error] Decompress Error:', e);\n            console.log('[Error] raw data:', reader.result);\n          }\n        });\n    };\n};\n\nexport default {\n  kataAnalyze,\n  genPlayMessage,\n  checkSocket,\n  initBoardFromMap,\n  sendCommonGtp,\n  aiPlay,\n  askHelp,\n  finishBoard,\n  defineMessage,\n};\n","/* eslint-disable no-this-before-super */\nimport React, {useState} from 'react';\nimport {set, get} from '../../util/storage.js';\nimport {Button, Upload} from 'antd';\nimport {UploadOutlined, DownloadOutlined} from '@ant-design/icons';\nconst sgf = require('../../util/sgf/main.js');\nconst FileSaver = require('file-saver');\nimport {useTranslation} from 'react-i18next';\n\nconst convertTable = {A: 0, B: 1, C: 2, D: 3, E: 4, F: 5, G: 6, H: 7, I: 8, J: 9, K: 10, L: 11,\nM: 12, N: 13, O: 14, P: 15, Q: 16, R: 17, S: 18, T: 19, U: 20, V: 21, W: 22, X: 23, Y: 24, Z: 25,\na: 0, b: 1, c: 2, d: 3, e: 4, f: 5, g: 6, h: 7, i: 8, j: 9, k: 10, l: 11, m: 12, n: 13, o: 14,\np: 15, q: 16, r: 17, s: 18, t: 19, u: 20, v: 21, w: 22, x: 23, y: 24, z: 25};\n\nconst ReadSGF = (props) => {\n    // ============  old version start  ============\n    // const {t} = useTranslation();\n    // const showFile = async function(e) {\n    //     e.preventDefault();\n    //     const reader = new FileReader();\n    //     reader.onload = async (e) => {\n    //         const text = (e.target.result);\n    //         set('sgfText', text);\n    //     };\n    //     reader.readAsText(e.target.files[0]);\n    // };\n    // return (\n    //     <div className=\"ReadSGF\">\n    //         {/* <input type=\"file\" onChange={(e) => showFile(e)} /> */}\n    //     </div>\n    // );\n    // ============  old version end  ============\n\n    const {t} = useTranslation();\n    const getTextInfo=(file)=>{\n        const reader=new FileReader();\n        reader.readAsText(file);\n        reader.onload=(result)=>{\n            const text=result.target.result;\n            set('sgfText', text);\n            // console.log('target: ', text);\n        };\n        return false;\n    };\n\n    return (\n        <Upload action=\"\" accept=\".sgf\" beforeUpload={getTextInfo} showUploadList={false}>\n            <Button icon={<UploadOutlined />}>{t('上传SGF')}</Button>\n        </Upload>\n    );\n};\n\nconst SaveSGF = () => {\n    const {t} = useTranslation();\n    const saveFile = function(data) {\n        if (data == null || data == 'null' || data == false) {\n            // TODO alert 尚未落子\n            console.log('尚未落子');\n        }\n        const content = sgf.stringify([data['currentGameTree']], {linebreak: ''});\n        const blob = new Blob([content], {type: 'text/plain;charset=utf-8'});\n\n        FileSaver.saveAs(blob, 'SGF.sgf');\n    };\n\n    return (\n        <div className=\"SaveSGF\">\n            <Button icon={<DownloadOutlined />} onClick={() => {\n                const sgf = get('gameStatus');\n                if (sgf == false) {\n                    alert('sgf not exit');\n                }\n                saveFile(JSON.parse(sgf));\n            }}>\n                {t('下载SGF')}\n            </Button>\n        </div>\n    );\n};\n\n// 导出当前模块\nexport {\n    ReadSGF,\n    SaveSGF,\n    convertTable,\n};\n","import {get, set} from '../storage';\nimport sgf from './main.js';\nimport GameTree from '@sabaki/immutable-gametree';\nimport {windowModalComp} from '../helper.js';\nimport {convertTable} from '../../components/sgf/index';\n\nlet SGFPlayedNodeList = [];\n\n// 获得已播放SGFList\nexport function getSGFPlayedNodeList() {\n  return SGFPlayedNodeList;\n}\n\n// 清空已播放SGFList\nexport function clearSGFPlayedNodeList() {\n  return SGFPlayedNodeList = [];\n}\n\n/*\n  落子加入Tree记录\n*/\nexport function addNewNode(sign, vertex, gameStatus) {\n  const color = sign == 1 ? 'B': 'W';\n  // gameStatus.currentGameTree.merger(\n  //   gameStatus.currentGameTree.get(gameStatus.treePosition),\n  //   {[color]: [sgf.stringifyVertex(vertex)]});\n  let id;\n  console.log('[*] gamestatus before addNewNode', gameStatus);\n  console.log('[*] gamestatus before addNewNode', JSON.stringify(gameStatus));\n  console.log('newTree.getHeight before: ', gameStatus['currentGameTree'].getHeight());\n  let newTree;\n  // 无任何子，落子与id=0的位置\n  // console.log('gameStatus[\\'currentGameTree\\']: ', JSON.stringify(gameStatus['currentGameTree']));\n  // console.log('gameStatus[\\'currentGameTree\\'][\\'children\\']: ', JSON.stringify(gameStatus['currentGameTree']['children']));\n  // console.log('gameStatus[\\'currentGameTree\\'][\\'id\\']: ', JSON.stringify(gameStatus['currentGameTree']['id']));\n  // console.log('gameStatus[\\'currentGameTree\\'][\\'data\\']: ', JSON.stringify(gameStatus['currentGameTree']['data']));\n  // console.log('gameStatus[\\'currentGameTree\\'][\\'parentId\\']: ', JSON.stringify(gameStatus['currentGameTree']['parentId']));\n  // console.log('gameStatus[\\'currentGameTree\\'][\\'data\\']==[]: ', gameStatus['currentGameTree']['children']==undefined);\n  // if (gameStatus['currentGameTree']['children']==undefined) {\n  // if (gameStatus.treePosition==0 && gameStatus['currentGameTree']['children']==undefined) {\n    if (gameStatus.stepNum==0) {\n    newTree = gameStatus.currentGameTree.mutate((draft) => {\n      draft.addToProperty(draft.root.id,\n        color, sgf.stringifyVertex(vertex));\n    });\n    id = 0;\n  } else {\n    // console.log('[*] vertex in addNewNode', vertex);\n    newTree = gameStatus.currentGameTree.mutate((draft) => {\n      id = draft.appendNode(gameStatus.treePosition,\n        {[color]: [sgf.stringifyVertex(vertex)]});\n    });\n  }\n  gameStatus.currentGameTree = newTree;\n  gameStatus.treePosition = id;\n  gameStatus.stepNum ++;\n  // 记录gameStatus\n  set('gameStatus', gameStatus);\n  return gameStatus;\n  // console.log('[*] gamestatus after addNewNode', JSON.stringify(gameStatus));\n  // console.log('[*] gamestatus after addNewNode', getStringChild(gameStatus));\n}\n\n// 初始化gameStatus\nexport function initGameStatus(emptyTree) {\n  emptyTree['data'] = {CP: ['hello']};\n  return emptyTree;\n}\n\nexport function readSGFTree(gameStatus) {\n  const content = get('sgfText') || '';\n  if (content === '') {\n    windowModalComp('提示', '棋谱获取失败');\n    return;\n  }\n  const lastId = getTotalNodesNum(content)-1;\n  const getId = ((id) => () => id++)(lastId);\n  const rootNodes = sgf.parse(content, getId);\n  const gameTrees = rootNodes.map((rootNode) => {\n      return new GameTree({getId, root: rootNode});\n  });\n  // console.log('[SGF] json1 gameTrees: ', JSON.stringify(gameTrees));\n  gameStatus['currentGameTree'] = gameTrees;\n  gameStatus['sgf'] = content;\n  gameStatus['treePosition'] = 0;\n  gameStatus['stepNum'] = lastId+1;\n  // console.log('[SGF]] gameStatus: ', gameStatus);\n}\n\nfunction getTotalNodesNum(content) {\n  let totalNodeNum = 0;\n  let reg = new RegExp(';B\\\\[', 'g');\n  totalNodeNum += content.match(reg).length;\n  reg = new RegExp(';W\\\\[', 'g');\n  totalNodeNum += content.match(reg).length;\n  return totalNodeNum;\n}\n\n\nexport function getStringChild(gameStatus) {\n  return JSON.stringify(gameStatus['currentGameTree']['root']['children']);\n}\n\n// 解析棋子数据，棋子数据：(W: [\"cd\"])\nexport function parseNodeData(Node) {\n  let color;\n  let posStr;\n  const pos = [];\n  if (Node['W']) {\n      color = -1;\n      posStr = Node['W'];\n  } else {\n      color = 1;\n      posStr = Node['B'];\n  }\n  pos.push(convertTable[posStr[0]]);\n  pos.push(convertTable[posStr[1]]);\n  return {color: color, pos: pos};\n}\n\n","\nimport React from 'react';\n\nimport {convertTable} from '../sgf/index.jsx';\nimport {useTranslation} from 'react-i18next';\nimport Battle from '../../api/battle';\nimport {Tooltip, Button, Modal} from 'antd';\nimport {useSelector, useDispatch} from 'react-redux';\nimport {CaretLeftOutlined, CaretRightOutlined, ClearOutlined, QuestionOutlined, ForwardOutlined, BackwardOutlined} from '@ant-design/icons';\nimport {getSGFPlayedNodeList, addNewNode, parseNodeData} from '../../util/sgf/fn';\nimport './operatorPanel.css';\nimport {windowModalComp, stackpush, translate} from '../../util/helper.js';\nimport {GameMode} from '../../util/constant.js';\nconst {askHelp, finishBoard, sendCommonGtp} = Battle;\n\nfunction checkNoSGF(gameStatus) {\n  if (gameStatus['sgf'] == null) {\n    Modal.info({\n      title: translate('提示'),\n      content: translate('请先上传SGF棋谱或选择搜索的棋谱或者切换模式'),\n      onOk: () => {},\n    });\n    return true;\n  }\n}\n\n// ======= gameTrees Demo Start =========\n// [{'id': 0, 'data': {'B': ['fl']}, 'parentId': null, 'children': [{'id': 1, 'data': {'W': ['pd']}, 'parentId': 0, 'children': [{'id': 2, 'data': {'B': ['ii']}, 'parentId': 1, 'children': [{'id': 3, 'data': {'W': ['nd']}, 'parentId': 2, 'children': [{'id': 4, 'data': {'B': ['kk']}, 'parentId': 3, 'children': [{'id': 5, 'data': {'W': ['dp']}, 'parentId': 4, 'children': [{'id': 6, 'data': {'B': ['kn']}, 'parentId': 5, 'children': [{'id': 7, 'data': {'W': ['dn']}, 'parentId': 6, 'children': [{'id': 8, 'data': {'B': ['jm']}, 'parentId': 7, 'children': [{'id': 9, 'data': {'W': ['qp']}, 'parentId': 8, 'children': [{'id': 10, 'data': {'B': ['go']}, 'parentId': 9, 'children': [{'id': 11, 'data': {'W': ['cd']}, 'parentId': 10, 'children': []}]}]}]}]}]}]}]}]}]}]}]}];\n// ======= gameTrees Demo End =========\n// 获取position对应的node的data\nfunction getNodeDataAtPosition(gameTrees, position) {\n  // console.log('gameTrees: ', gameTrees);\n  // console.log('gameTrees: ', JSON.stringify(gameTrees));\n  // console.log('position: ', position);\n  let node;\n  if (position == 0) {\n    const data = gameTrees[0]['root']['data'];\n    return data;\n  }\n  node = [gameTrees[0]['root']];\n  for (let i = 0; i < position; i++) {\n    node = node[0]['children'];\n  }\n  const data = node[0]['data'];\n  return data;\n}\n\n// 初始化棋盘控制按钮组件\nexport default function OperatorPanel(props) {\n  const {gameStatus, board, setBoard, mode, shareData, startGame, historyBoardList, setHistoryBoardList, futureBoardList, setFutureBoardList, lastNode, setLastNode} = props;\n  const {t} = useTranslation();\n  const SGFPlayedNodeList = getSGFPlayedNodeList();\n  // const dispatch = useDispatch();\n  // const gobackN = useSelector((state) => state.kataData.gobackN);\n\n  const nextMove = () =>{\n    // [TODO] 添加下完后的提示\n    if (mode === GameMode.SGF) {\n      if (checkNoSGF(gameStatus)) {\n        return;\n      }\n      console.log('play sgf gamestatus: ', gameStatus);\n      // position: 下一步棋的位置\n      const position = gameStatus['treePosition'];\n      // 下一步棋的位置即为已经下了的棋子数(position从0开始)，已经下了的棋子数==总棋子数，则无棋可下\n      if (position == gameStatus['stepNum']) {\n          return;\n      }\n      // console.log('[SGF PLAY] SGFPlayedNodeList', SGFPlayedNodeList);\n      const node = getNodeDataAtPosition(gameStatus['currentGameTree'], position);\n      // 此处记录当前board, 以供悔棋\n      stackpush(historyBoardList, board);\n      setHistoryBoardList(historyBoardList);\n      // 下黑棋\n      if (node['B']) {\n          const newBoard = board.makeMove(1, [convertTable[node['B'][0][0]], convertTable[node['B'][0][1]]]);\n          SGFPlayedNodeList.push({'B': [convertTable[node['B'][0][0]], convertTable[node['B'][0][1]]]});\n          setBoard(newBoard);\n      }\n      // 下白棋\n      if (node['W']) {\n          const newBoard = board.makeMove(-1, [convertTable[node['W'][0][0]], convertTable[node['W'][0][1]]]);\n          SGFPlayedNodeList.push({'W': [convertTable[node['W'][0][0]], convertTable[node['W'][0][1]]]});\n          setBoard(newBoard);\n      }\n      gameStatus['treePosition']++;\n    } else if (mode === GameMode.Free || mode === GameMode.HumanVSComputer || mode === GameMode.HumanVSComputerWithFriend) {\n      // 从悔棋生成的un-undo列表中取出上一步悔棋操作, 如果没有, 则不操作\n      // [TODO] 悔棋若干步后，只能前进一步。前进一步后需要清空悔棋数据。\n      // 判断是否有悔棋数据\n      if (lastNode == null) {\n        console.log('[ERR]: 无悔棋数据');\n        return;\n      }\n      // 更新gameStatus\n      addNewNode(lastNode['sign'], lastNode['pos'], gameStatus);\n      // lastNode即为撤销悔棋要下的棋子，在此处使用完成后会被置空\n      const newBoard = futureBoardList.pop();\n      if (newBoard) {\n        setBoard(newBoard);\n        shareData.board = newBoard;\n        setFutureBoardList(futureBoardList);\n        // [TODO] 这里还要发送play命令和genmove命令\n      }\n      // 更新lastNode为空，悔棋棋子已用\n      setLastNode(null);\n    }\n  };\n\n  const nextMove5time = () => {\n    if (mode === GameMode.SGF) {\n      if (checkNoSGF(gameStatus)) {\n          return;\n      }\n      let newBoard = board;\n      for (let i = 0; i < 5; i++) {\n        const position = gameStatus['treePosition'];\n        // 无子可下\n        if (position == gameStatus['stepNum']) {\n            break;\n        }\n        stackpush(historyBoardList, newBoard);\n        const node = getNodeDataAtPosition(gameStatus['currentGameTree'], position);\n        // 下黑棋\n        if (node['B']) {\n            newBoard = newBoard.makeMove(1, [convertTable[node['B'][0][0]], convertTable[node['B'][0][1]]]);\n            SGFPlayedNodeList.push({'B': [convertTable[node['B'][0][0]], convertTable[node['B'][0][1]]]});\n        }\n        // 下白棋\n        if (node['W']) {\n            newBoard = newBoard.makeMove(-1, [convertTable[node['W'][0][0]], convertTable[node['W'][0][1]]]);\n            SGFPlayedNodeList.push({'W': [convertTable[node['W'][0][0]], convertTable[node['W'][0][1]]]});\n        }\n        gameStatus['treePosition']++;\n      }\n      setHistoryBoardList(historyBoardList);\n      setBoard(newBoard);\n    } else if (mode === GameMode.Free || mode === GameMode.HumanVSComputer || mode === GameMode.HumanVSComputerWithFriend) {\n      // [TODO] 在对战模式下，不存在前进五步\n      // 从悔棋生成的un-undo列表中取出上一步悔棋操作, 如果没有, 则不操作\n      let newBoard = null;\n      let lastBoard = null;\n      for (let i=0; i<5; i++) {\n        newBoard = futureBoardList.pop();\n        if (newBoard) {\n          lastBoard = newBoard;\n          // [TODO] 这里还要发送play命令和genmove命令\n        } else {\n          // 没有可用操作,提前结束\n          break;\n        }\n      }\n      if (lastBoard) {\n        setBoard(lastBoard);\n        shareData.board = lastBoard;\n        setFutureBoardList(futureBoardList);\n      }\n    }\n  };\n\n  const backMove = () =>{\n    if (mode === GameMode.SGF) {\n      if (checkNoSGF(gameStatus)) {\n        return;\n      }\n      console.log('backMove gameStatus: ', gameStatus);\n      // 下一步为0，当前无子\n      if (gameStatus['treePosition'] == 0) {\n        return;\n      }\n      // 记录lastNode\n      const lastNodeTmp = getNodeDataAtPosition(gameStatus['currentGameTree'], gameStatus['treePosition']-1);\n      const tmp = parseNodeData(lastNodeTmp);\n      setLastNode({sign: tmp['color'], pos: tmp['pos']});\n      // 更新gameStatus\n      gameStatus['treePosition']--;\n      // 播放模式不需要发送undo\n      // 进行historyBoard、futureBoardList的更新;\n      const historyBoard = historyBoardList.pop();\n      if (!historyBoard) {\n        return;\n      }\n      // 悔棋前把当前棋盘加入futureBoard\n      stackpush(futureBoardList, board);\n      setFutureBoardList(futureBoardList);\n      // 悔棋, 拿\b栈里的board覆盖\n      setBoard(historyBoard);\n      shareData.board = historyBoard;\n      setHistoryBoardList(historyBoardList);\n    } else\n    if (mode === GameMode.HumanVSComputer || mode === GameMode.HumanVSComputerWithFriend || mode === GameMode.Free) {\n      // [TODO]更新gameStatus，注意双数id变化\n      const lastNodeTmp = gameStatus['currentGameTree']['root']['children'].pop()['data'];\n      const tmp = parseNodeData(lastNodeTmp);\n      setLastNode({sign: tmp['color'], pos: tmp['pos']});\n\n      const historyBoard = historyBoardList.pop();\n      if (!historyBoard) {\n        return;\n      }\n      // 悔棋前把当前棋盘加入futureBoard\n      stackpush(futureBoardList, board);\n      setFutureBoardList(futureBoardList);\n      // 悔棋, 拿\b栈里的board覆盖\n      setBoard(historyBoard);\n      shareData.board = historyBoard;\n      setHistoryBoardList(historyBoardList);\n      // 发送悔棋gtp命令, 让服务端悔棋\n      sendCommonGtp(null, 'undo');\n    }\n  };\n\n  const backMove5time = () => {\n    let lastBoard = null;\n    if (mode === GameMode.SGF) {\n      for (let i=0; i<5; i++) {\n        const historyBoard = historyBoardList.pop();\n        // 下一步为0，当前无子,下一步不为0，当前可悔棋\n        if (gameStatus['treePosition'] != 0) {\n          // 记录lastNode\n          const lastNodeTmp = getNodeDataAtPosition(gameStatus['currentGameTree'], gameStatus['treePosition']-1);\n          const tmp = parseNodeData(lastNodeTmp);\n          setLastNode({sign: tmp['color'], pos: tmp['pos']});\n          // 更新gameStatus\n          gameStatus['treePosition']--;\n        }\n        if (historyBoard) {\n          // 悔棋前把当前棋盘加入futureBoard\n          if (i==0) {\n            stackpush(futureBoardList, board);\n          } else {\n            stackpush(futureBoardList, lastBoard);\n          }\n          lastBoard = historyBoard;\n          // [TODO] 添加对gameStatus和sgfTree的变更\n        } else {\n          break;\n        }\n      };\n      if (lastBoard) {\n        // 历史栈中有棋盘可以悔棋\n        setHistoryBoardList(historyBoardList);\n        setFutureBoardList(futureBoardList);\n        shareData.board = lastBoard;\n        setBoard(lastBoard);\n      }\n    } else\n    if (mode === GameMode.HumanVSComputer || mode === GameMode.HumanVSComputerWithFriend || mode === GameMode.Free) {\n      for (let i=0; i<5; i++) {\n        // [TODO]更新gameStatus，注意双数id变化\n        // console.log(gameStatus['currentGameTree']['root']['children']);\n        const lastNodeTmp = gameStatus['currentGameTree']['root']['children'].pop()['data'];\n        const tmp = parseNodeData(lastNodeTmp);\n        setLastNode({sign: tmp['color'], pos: tmp['pos']});\n        // 更新historyBoard\n        const historyBoard = historyBoardList.pop();\n        if (historyBoard) {\n          // 悔棋前把当前棋盘加入futureBoard\n          if (i==0) {\n            stackpush(futureBoardList, board);\n          } else {\n            stackpush(futureBoardList, lastBoard);\n          }\n          lastBoard = historyBoard;\n          sendCommonGtp(null, 'undo');\n        } else {\n          break;\n        }\n      };\n      if (lastBoard) {\n        setHistoryBoardList(historyBoardList);\n        setFutureBoardList(futureBoardList);\n        shareData.board = lastBoard;\n        setBoard(lastBoard);\n      }\n    }\n  };\n\n  // if (gobackN !==0 && gobackN !== null) {\n  //   // 悔棋\n  //   const reminder = gobackN % 5;\n  //   const goback5 = parseInt(gobackN/5);\n  //   for (let i=0; i < goback5; i++) {\n  //     backMove5time();\n  //   }\n  //   for (let i=0; i < reminder; i++) {\n  //     backMove();\n  //   }\n  //   dispatch({type: 'kataData/gobackN', id: null});\n  // }\n\n  const clearBoard = () => {\n    windowModalComp('提示', '是否要清空棋盘,重新开始对局', finishBoard, ()=>{}, '是', '否');\n  };\n\n  return (\n    <div className=\"operator-panel\">\n      <div className=\"operator-card\">\n        <Tooltip placement=\"topLeft\" title={t('上一步*5/悔棋')}>\n          <Button disabled={historyBoardList.length <= 0} icon={<BackwardOutlined />} onClick={backMove5time}></Button>\n        </Tooltip>\n        <Tooltip placement=\"topLeft\" title={t('上一步/悔棋')}>\n          <Button disabled={historyBoardList.length <= 0} icon={<CaretLeftOutlined />} onClick={backMove}></Button>\n        </Tooltip>\n        <Tooltip placement=\"topLeft\" title={t('下一步')}>\n          <Button disabled={(mode!=='SGF' && futureBoardList.length <= 0)} icon={<CaretRightOutlined />} onClick={nextMove}></Button>\n        </Tooltip>\n        <Tooltip placement=\"topLeft\" title={t('下一步*5')}>\n          <Button disabled={(mode!=='SGF' && futureBoardList.length <= 0)} icon={<ForwardOutlined />} onClick={nextMove5time}></Button>\n        </Tooltip>\n        <Tooltip placement=\"topLeft\" title={t('请求帮助')}>\n          <Button disabled={mode==='SGF' || !startGame} icon={<QuestionOutlined />} onClick={askHelp}></Button>\n        </Tooltip>\n        <Tooltip placement=\"topLeft\" title={t('清空棋盘')}>\n          <Button disabled={!startGame} icon={<ClearOutlined />} onClick={clearBoard}></Button>\n        </Tooltip>\n      </div>\n    </div>\n  );\n};\n","import React, {useState, useEffect} from 'react';\nimport {useMount} from 'ahooks';\nimport {useSelector, useDispatch} from 'react-redux';\n\nimport Goban from '../goboard/Goban';\nimport Board from '@sabaki/go-board';\nimport '../../assets/css/goban.css';\n\nimport {windowModalComp} from '../../util/helper';\n\nimport {Alert} from 'antd';\nimport {GameMode} from '../../util/constant.js';\nimport {set} from '../../util/storage';\nimport Battle from '../../api/battle';\n\nimport GameTree from '@sabaki/immutable-gametree';\nimport {addNewNode, clearSGFPlayedNodeList, initGameStatus, readSGFTree} from '../../util/sgf/fn';\nimport OperatorPanel from './operatorPanel.jsx';\n\nimport Cookies from 'js-cookie';\nimport {Spin} from 'antd';\n\nimport './index.css';\n\n\nconst {aiPlay, sendCommonGtp, finishBoard} = Battle;\n\nconst isLegal = function(board, color, pos) {\n  // 检查入参是否非法\n  if (!board || !(board instanceof Board)) {\n    return false;\n  }\n  if (color!==1 && color!==-1) {\n    return false;\n  }\n  if (!Array.isArray(pos) || pos.length !== 2) {\n    return false;\n  }\n  const x = pos[0];\n  const y = pos[1];\n  // 选择位置已有棋子\n  if (board.get([x, y]) !== 0) {\n    console.log('[#] 落子失败,此处已有棋子');\n    return false;\n  }\n  return true;\n};\n\n// 共享状态,用于ws和组件交互\nconst shareData = {kataData: []};\n\nexport default function CustomGobangBoard(props) {\n\tconst {signMap, showCoordinates, fuzzyStonePlacement, mode, ws, uploadState} = props;\n  const [loading, setLoading] = useState(true); // 棋盘加载层\n\tconst [board, setBoard] = useState(new Board(signMap)); // 棋盘\n  const [bindMessage, setBindMessage] = useState(false); // 是否已绑定ws事件\n  // const [emptyTree, setEmptyTree] = useState(new GameTree()); // 棋盘状态树\n  const [gameStatus, setGameStatus] = useState({}); // 棋盘状态对象\n  const [startGame, setStartGame] = useState(false); // 是否开始游戏\n  const [message, setMessage] = useState(''); // 棋局相关信息\n  const [historyBoardList, setHistoryBoardList] = useState([]); // 悔棋用棋盘栈\n  const [futureBoardList, setFutureBoardList] = useState([]); // 悔棋后反悔的棋盘栈\n  const [lastNode, setLastNode] = useState(null);// 最后的落子，用于悔棋；在悔棋时更新为撤掉的本方子；数据结构{sign: sign, pos: [x, y]}\n\n  const dispatch = useDispatch();\n  // let gameStatus = {};// 棋盘状态对象\n  const emptyTree = new GameTree();\n\n  const clearBoard = (board, setBoard, gameStatus, setGameStatus, sendCommonGtp) => {\n    // 清空棋盘, 重置gtp通讯\n    Cookies.set('gtpHistory', '');\n    Cookies.set('gtpId', 1);\n    board.clear();\n    setBoard(board);\n    sendCommonGtp(null, 'clear_board');\n    setStartGame(false);\n    const newGameStatus = {\n      currentGameTree: initGameStatus(emptyTree),\n      treePosition: emptyTree.root.id,\n      sgf: null,\n      nodeArray: null,\n      stepNum: 0,\n    };\n    setGameStatus(newGameStatus);\n    set('gameStatus', null);\n    set('emptyTree', null);\n    clearSGFPlayedNodeList();\n    dispatch({type: 'kataData/gameStatus',\n      gameStatus: JSON.stringify({\n        ...newGameStatus.currentGameTree.root,\n      }),\n    });\n  };\n\n  useMount(() => {\n    console.log('[*] 棋盘组件挂载');\n    shareData.addNewNode = addNewNode;\n    set('gameStatus', null);\n    set('emptyTree', null);\n    const newGameStatus = {\n      currentGameTree: initGameStatus(emptyTree),\n      treePosition: emptyTree.root.id,\n      sgf: null,\n      nodeArray: null,\n      stepNum: 0,\n    };\n    setGameStatus(newGameStatus);\n    // {\"id\":0,\"data\":{},\"parentId\":null,\"children\":[]},\"treePosition\":0,\"sgf\":null,\"nodeArray\":null,\"stepNum\":0}\n    dispatch({type: 'kataData/gameStatus',\n      gameStatus: JSON.stringify({\n        ...newGameStatus.currentGameTree.root,\n      }),\n    });\n  });\n\n  // 绑定ws的交互事件, 声明shareData\n  useEffect(() => {\n    if (ws && !bindMessage) {\n      shareData.dispatch = dispatch; // 使ws回调函数可以与redux数据进行交互\n      shareData.board = board;\n      shareData.setBoard = setBoard;\n      shareData.setLoading = setLoading;\n      shareData.showAlert = showAlert;\n      shareData.gameStatus = gameStatus;\n      shareData.setGameStatus = setGameStatus;\n      shareData.clearBoard = clearBoard;\n      shareData.windowModalComp = windowModalComp;\n      shareData.setStartGame = setStartGame;\n      shareData.initBoardStatus = false;\n      ws.removeEventListener('message', Battle.defineMessage(shareData));\n      ws.addEventListener('message', Battle.defineMessage(shareData));\n      setBindMessage(true);\n      setLoading(false);\n    }\n  }, [ws]);\n\n  useEffect(() => {\n    if (mode === GameMode['SGF']) {\n      readSGFTree(gameStatus);\n      finishBoard();\n    }\n    if (mode === GameMode['HumanVSComputer']) {\n      finishBoard();\n    }\n    if (mode === GameMode['HumanVSComputerWithFriend']) {\n      finishBoard();\n    }\n  }, [mode]);\n\n  // 监听关键的state,上传给父组件\n  // 变量改变后需要再次同步,太麻烦了,弃用\n  // useEffect(() => {\n  //   uploadState({startGame}, {setBoard});\n  // }, []);\n\n  const showAlert = (text, time = 1000) => {\n    setMessage(text);\n    setTimeout(()=>{\n      setMessage('');\n    }, time);\n  };\n\n  const vertexEvent = (evt, [x, y]) => {\n    // 加载中,禁用点击事件\n    if (loading) {\n      return;\n    }\n    if (mode === 'SGF') {\n      return;\n    }\n    // [x, y]与signMap的索引是转置关系,取位置时应该取signMap[y][x]\n    // 棋盘左上角是(0,0),右下角是(18,18)\n    // console.log('[#] 用户落子:', [x, y]);\n    const sign = evt.button === 0 ? 1 : -1; // 空白、黑子、白子\n    // 落子是否合法\n    if (!isLegal(board, sign, [x, y])) {\n      // console.log('[#] 落子非法');\n      showAlert('此处已有棋子');\n      return false;\n    }\n    // 更新Tree记录\n    addNewNode(sign, [x, y], gameStatus);\n    dispatch({type: 'kataData/gameStatus', gameStatus: JSON.stringify({\n      ...gameStatus.currentGameTree.root,\n    })});\n\n    const newBoard = board.makeMove(sign, [x, y]);\n    if (newBoard.get([x, y]) !== sign) {\n      // 不符合落子规则,不能落子\n      showAlert('落子不符合规则');\n      return false;\n    }\n\n    // 更新棋盘, 并同步给shareData!否则ws会获取旧的棋盘数据\n\t\tsetBoard(newBoard);\n    shareData.board = newBoard;\n    historyBoardList.push(board); // 每当有新board出现,旧board就会存储到栈中\n    // 更新gameStatus\n    shareData.gameStatus = gameStatus;\n\t\t// 如果是人机模式,则请求电脑落子\n\t\tif (mode === GameMode.HumanVSComputer || mode === GameMode.HumanVSComputerWithFriend || mode === GameMode.Free) {\n      // 存储落子信息\n      Cookies.set('playOperation', JSON.stringify({sign, pos: [x, y]}));\n      // loading等待ws回复\n      setLoading(true);\n      if (!startGame) {\n        // 第一次落子, 开启初始化棋盘进程\n        shareData.initBoardStatus = true;\n        sendCommonGtp(ws, 'name');\n        setStartGame(true);\n      } else {\n        // 棋局进行中\n        // console.log('[#] 人机模式请求电脑落子');\n        // 发送玩家操作, 通过onmessage事件监听等待服务端返回\n        aiPlay({sign, pos: [x, y]});\n      }\n\t\t};\n  };\n\n  return (\n    <div className='game-panel'>\n      {loading && <div className=\"goban-spin\"><Spin tip=\"加载中...\" /></div>}\n      <div className='message-container'>{message.length > 0 && <Alert message={message} type=\"error\" />}</div>\n        <Goban\n          board={board}\n          signMap={board.signMap}\n          animate={true}\n          vertexSize={24}\n          onVertexMouseUp={vertexEvent}\n          showCoordinates={showCoordinates}\n          fuzzyStonePlacement={fuzzyStonePlacement}\n          isBusy={loading}\n        />\n      <OperatorPanel mode={mode} futureBoardList={futureBoardList} setFutureBoardList={setFutureBoardList} historyBoardList={historyBoardList} setHistoryBoardList={setHistoryBoardList} gameStatus={gameStatus} board={board} setBoard={setBoard} shareData={shareData} startGame={startGame} setStartGame={setStartGame} lastNode={lastNode} setLastNode={setLastNode}/>\n    </div>\n  );\n};\n","import React, {useState} from 'react';\nimport {Button, Select} from 'antd';\nimport {SearchOutlined} from '@ant-design/icons';\nimport {set} from '../../util/storage.js';\nimport {get, getResponse, getWithoutServerAddr} from '../../util/fetch';\nimport {clearSGFPlayedNodeList} from '../../util/sgf/fn';\nimport {useTranslation} from 'react-i18next';\nimport {translate} from '../../util/helper.js';\nimport './index.css';\n\nconst {Option} = Select;\nconst debug = false;\n\nlet consoleLog;\nif (debug) {\n  consoleLog = console.log;\n} else {\n  consoleLog = ()=>{};\n}\n\n\nfunction handlText(text) {\n  let newText = '';\n  let l = 0;\n  let f = 0;\n  for (let i = 0; i < text.length; i++) {\n      if (text[f] == ';' && (text[f+1] == 'B' || text[f+1] == 'W') && text[f+2]=='[' && text[f+5]==']') {\n          newText+=text.slice(l, f) + '(' + text.slice(f, f+6) + ')';\n          l = f+6;\n      }\n      if (f+6 >= text.length) {\n          newText+=text.slice(l, f+5);\n          return newText;\n      }\n      f++;\n  }\n  return newText;\n}\n\n/*eslint-disable*/\nconst SGFSelect = React.forwardRef((props, ref) => (\n  <Select\n    showSearch\n    style={{\n      width: '80%',\n      minWidth: 's250px',\n    }}\n    placeholder={t('搜索SGF棋谱')}\n    onSearch={props.handleSearch}\n    onBlur={props.onBlur}\n    open={props.open}\n    autoFocus={props.autoFocus}\n    // onSearch={handleChange}\n    notFoundContent={null}\n    suffixIcon={null}\n    ref = {ref}\n    searchValue={props.searchValue}\n    >\n    {props.candidatesList}\n  </Select>\n));\n/* eslint-enable */\n\nconst ExternalSGF = () => {\n  const {t} = useTranslation();\n  const [value, setValue] = useState(undefined);\n  const [searchValue, setSearchValue] = useState('');\n  const [placeholder, setPlaceholder] = useState('搜索SGF棋谱');\n  const [loading, setLoading] = useState(false);\n  const [open, setOpen] = useState(false);\n  const [notFoundContent, setNotFoundContent] = useState(null);\n  const [candidatesList, setCandidatesList] = useState([]);\n  const [candidatesNameList, setCandidatesNameList] = useState([]);\n  const [fromFocusFlag, setFromFocusFlag] = useState(false);\n  const ref = React.createRef();\n\n  async function fetchSGFList(keyword) {\n    setNotFoundContent(null);\n    setLoading(true);\n    consoleLog('[SGF]fetchSGFList keyword: ', keyword);\n    const url = `/qq/?keyword=${keyword}&pageSize=10&lastCode=xxxxx`;\n    const resRaw = await get(url);\n    const res = await getResponse(resRaw);\n    const tmpCandidatesNameList = [];\n    const data = res.data;\n    setLoading(false);\n    if (!data) {\n      consoleLog('server return nothing, return in fetchSGFList');\n      setNotFoundContent(t('暂无数据'));\n      return;\n    }\n    consoleLog('search res: ', data);\n    setCandidatesList(data);\n    for (let i = 0; i < data.length; i++) {\n      tmpCandidatesNameList.push(<Option key={i}>{data[i]['Gn']}</Option>);\n    }\n    consoleLog('tmpCandidatesNameList: ', tmpCandidatesNameList);\n    setCandidatesNameList(tmpCandidatesNameList);\n    return tmpCandidatesNameList.map((value, index) => ({\n      label: value,\n      value: index,\n    }));\n  }\n\n  // fake fetch\n  /* async function fetchSGFList(keyword) {\n    const tmpChild = [];\n    for (let i = 10; i < 36; i++) {\n      tmpChild.push(<Option key={i.toString(36) + i}>{i.toString(36) + i}</Option>);\n    }\n    setCandidatesNameList(tmpChild);\n  } */\n\n  async function fetchSGF(sgfUrl) {\n    const resRaw = await getWithoutServerAddr(sgfUrl);\n    const text = await resRaw.text();\n    // console.log('sgftext', text);\n    return text;\n  }\n\n  async function handleSelectOption(index, option) {\n    if (!index) {\n      return;\n    }\n    consoleLog('[SGF]select option: ', option);\n    const sgfUrl = candidatesList[index]['SgfUrl'];\n    const sgfTextTmp = await fetchSGF(sgfUrl);\n    // 更换了正确的gameTree，直接拿sgf\n    // const sgfText = handlText(sgfTextTmp);\n    const sgfText = sgfTextTmp;\n    consoleLog('option[\"children\"]: ', option['children']);\n    consoleLog('sgfText: ', sgfText);\n    setValue(undefined);\n    setSearchValue(undefined);\n    setPlaceholder(option['children']);\n    setOpen(false);\n    // 模式切换数据写入相关操作\n    // 写入SGF\n    set('sgfText', sgfText);\n    // 清空SGFPlayedNodeList\n    clearSGFPlayedNodeList();\n    // TODO 清空棋盘\n  };\n\n  async function handleClickSearch(value) {\n    consoleLog('[SGF]click search: ', value);\n    setCandidatesNameList([]);\n    fetchSGFList(value);\n    setOpen(true);\n    setPlaceholder(value);\n    ref.current.focus();\n    setFromFocusFlag(true);\n  };\n\n  function onBlur() {\n    setFromFocusFlag(true);\n    consoleLog('Blur');\n    setOpen(false);\n    consoleLog('[SGF]Blur searchValue: ', searchValue);\n    setSearchValue(searchValue);\n\n    // console.log('setOpen: false');\n  }\n\n  async function handleInputSearch(value) {\n    // setValue('');\n    setValue('');\n    consoleLog('[SGF]input value', value);\n    setPlaceholder(undefined);\n    // setPlaceholder(undefined); \"搜索SGF棋谱\"之前为\"undefined\"\n    // consoleLog('[SGF]input fromFocusFlag', fromFocusFlag);\n    setOpen(false);\n    if (fromFocusFlag) {\n      setFromFocusFlag(false);\n    } else {\n      setSearchValue(value);\n    }\n  }\n\n  return (\n    <div className='sgf-search'>\n        <Select\n        showSearch\n        style={{\n          width: '80%',\n          minWidth: 's250px',\n        }}\n        placeholder={placeholder=='搜索SGF棋谱'?t('搜索SGF棋谱'):placeholder}\n        // placeholder={placeholder}\n        value={value}\n        onSearch={handleInputSearch}\n        searchValue={searchValue}\n        onChange={handleSelectOption}\n        loading={loading}\n        onBlur={onBlur}\n        open={open}\n        notFoundContent={notFoundContent}\n        suffixIcon={null}\n        filterOption={false}\n        ref={ref}\n        >\n          {candidatesNameList}\n      </Select>\n\n      <Button className='search-button' shape=\"circle\" icon={<SearchOutlined />} onClick={()=>{\n        handleClickSearch(searchValue);\n        }} />\n    </div>\n  );\n};\n\n// 导出当前模块\nexport {\n  ExternalSGF,\n};\n","import React, {useState, useEffect} from 'react';\nimport {Card, Modal, Divider, Select, Radio, Button, Tooltip} from 'antd';\nimport {useTranslation} from 'react-i18next';\nimport {GameMode, aiAddr} from '../../util/constant.js';\nimport {ReadSGF, SaveSGF} from '../../components/sgf';\nimport {ExternalSGF} from '../externalSGF';\nimport {set, get} from '../../util/storage';\nimport Cookies from 'js-cookie';\nimport {get as getFetch, getResponse} from '../../util/fetch';\nimport {getSGFPlayedNodeList} from '../../util/sgf/fn';\nimport {windowModalComp} from '../../util/helper';\nimport Battle from '../../api/battle';\nimport {translate} from '../../util/helper';\nimport {useSelector} from 'react-redux';\n\n\nconst {askHelp, initBoardFromMap, kataAnalyze} = Battle;\n\nimport './index.css';\nimport {useMount} from 'ahooks';\n\nconst {Option} = Select;\n\nconst GameModeList = (props) => {\n  const {t} = useTranslation();\n  const {changeGameMode, mode} = props;\n  const gameModeSwitch = (e) => {\n    const aimMode = e.target.value;\n    if (aimMode == mode) {\n      return;\n    }\n    if (mode == GameMode['SGF']) {\n      // 清空SGF文件\n      set('sgfText', null);\n      set('gameStatus', null);\n    }\n    if (aimMode === GameMode['SGF']) {\n      const sgfText = get('sgfText');\n      // console.log('[Mode] sgf: ', sgfText);\n      if (sgfText == 'null' || sgfText == false) {\n        Modal.info({\n          title: translate('提示'),\n          content: translate('请先上传SGF棋谱或选择搜索的棋谱'),\n          onOk: () => {},\n        });\n        return;\n      }\n    }\n    changeGameMode(GameMode[aimMode]);\n  };\n  // [TODO]模式切换\n  // SGF切换到自由对战。gameTree的操作：①给出当前下了的黑白棋顺序列表，向后端发送下棋数据√；②修改当前gameTree,如有必要更改hello、对弈者等额外信息，截取gameTree到已播放的位置；\n  return (\n    <div className='gamemode-button-list'>\n      <Radio.Group value={mode} onChange={gameModeSwitch} size='medium' buttonStyle=\"solid\">\n        {/* [DEMO] 组件中调用语言切换：\n          import {useTranslation} from 'react-i18next';\n          组件中：\n            const {t} = useTranslation();\n            {t('keyword')} --> 目标语言;\n          需提前在语言库中加对应关键字 */}\n        <Radio.Button value=\"HumanVSComputer\">{t('人机对弈')}</Radio.Button>\n        <Radio.Button value=\"HumanVSComputerWithFriend\">{t('联棋对弈')}</Radio.Button>\n        <Radio.Button value=\"Free\">{t('自由模式')}</Radio.Button>\n        <Radio.Button value=\"SGF\">{t('棋谱播放')}</Radio.Button>\n      </Radio.Group>\n    </div>\n  );\n};\n\nconst GameAISelect = () => {\n  const {t} = useTranslation();\n  const [optionList, setOptionList] = useState([]);\n  const [nowAIText, setNowAIText] = useState('AI:');\n  useMount(async ()=>{\n    const nowAI = await Cookies.get('aiId');\n    const resRaw = await getFetch(aiAddr);\n    const res = await getResponse(resRaw);\n    const {data=[]} = res || {};\n    const tmpOptionList = [];\n    data.forEach((item, ind)=>{\n      tmpOptionList.push(<Option value={item['UserId']} key={'ai_'+item['UserId']+ind}>{`${item['Name']}|是否可用:${item['Online']}|分析功能:${item['Analyze']}|能否对弈:${item['Genmove']}|最大上限:${item['Maxplayer']}|Vip:${item['Vip']}`}</Option>);\n    });\n    setOptionList(tmpOptionList);\n    setNowAIText('AI:' + nowAI);\n  });\n  const changeAI = (chooseAI) => {\n    Cookies.set('aiId', chooseAI);\n    setNowAIText('AI:' + chooseAI);\n    windowModalComp('提示', '已变更AI: '+ chooseAI);\n  };\n\n  return (\n    <div>\n      <span>{nowAIText||translate('未选择AI')}</span>\n      <Select onChange={changeAI} placeholder={t('选择对弈AI')} className=\"choose-ai-select\">\n        {optionList}\n      </Select>\n    </div>\n  );\n};\n\nexport default function LeftPanel(props) {\n  // const kataDataStatus = useSelector((state) => state.kataData.kataDataStatus);\n  const {t} = useTranslation();\n  const {changeGameMode, mode, ws, startGame} = props;\n  // 游戏分析状态\n  const [gameAnalysis, setGameAnalysis] = useState(false);\n\n  useEffect(() => {\n    Cookies.set('gameAnalysis', gameAnalysis);\n  }, [gameAnalysis]);\n\n  const sgfToFree = () => {\n      const nodeList = getSGFPlayedNodeList();\n      initBoardFromMap(nodeList, ws);\n      changeGameMode('Free');\n  };\n\n  const changeGameAnalysis = () => {\n    kataAnalyze(ws, gameAnalysis);\n    setGameAnalysis(!gameAnalysis);\n  };\n\n  return (\n    <div className='left-panel'>\n      <Card className=\"gamemode-card\" title={t('游戏模式')}>\n        <GameModeList changeGameMode={changeGameMode} mode={mode} />\n        {mode !== 'Free' && <Divider />}\n        {mode === 'HumanVSComputer' && <div>\n          <GameAISelect />\n          <Divider></Divider>\n          <Button disabled={startGame} onClick={changeGameAnalysis}>{t('AI分析')}:{gameAnalysis ? t('开启') : t('关闭')}</Button>\n          <Button className='ask-help-btn' onClick={askHelp}>{t('请求帮助')}</Button>\n        </div>\n        }\n        {\n          mode === 'HumanVSComputerWithFriend' &&\n          <GameAISelect />\n        }\n        {\n          mode === 'SGF' &&\n          <Tooltip placement=\"topLeft\" title='进入自由模式继续对弈'>\n            <Button onClick={sgfToFree}>{t('残局对弈')}</Button>\n          </Tooltip>\n        }\n      </Card>\n      <Card className=\"search-card\" title={t('SGF棋谱搜索')}>\n        <div className=\"search-card-container\"><ExternalSGF /></div>\n      </Card>\n      <Card title={t('棋谱管理(SGF)')} className=\"sgf-card\">\n        <Card.Grid style={{width: '50%', textAlign: 'center'}}><ReadSGF /></Card.Grid>\n        <Card.Grid style={{width: '50%', textAlign: 'center'}}><SaveSGF /></Card.Grid>\n      </Card>\n    </div>\n  );\n};\n","import React, {useState, useEffect, useRef} from 'react';\nimport ReactDOM from 'react-dom';\nimport {DagreGraph} from '@ant-design/charts';\nimport G6 from '@antv/g6';\nimport {useDispatch} from 'react-redux';\nimport {windowModalComp} from '../../util/helper';\n\nconst NodeTreeGraph =({data, width, height}) => {\n  const graphRef = useRef(null);\n  const [graph, setGraph] = useState(null);\n  const dispatch = useDispatch();\n  useEffect(()=>{\n    /* eslint-disable */\n    let graph = new G6.TreeGraph({\n      container: ReactDOM.findDOMNode(graphRef.current),\n      width,\n      height,\n      modes: {\n        default: [\n          {\n            type: 'custom'\n          },\n          'drag-canvas',\n          'zoom-canvas'\n        ]\n      },\n      defaultNode: {\n        size: 6,\n        style: {\n          fill: '#000',\n          stroke: '#aaa'\n        },\n        labelCfg: {\n          position: 'left',\n          fontSize: 1,\n          style: {\n            fill: '#ced'\n          }\n        }\n      },\n      defaultEdge: {\n        shape: 'cubic-horizontal',\n        style: {\n          stroke: '#000'\n        },\n        position: 'middle'\n      },\n      layout: {\n        type: 'dendrogram',\n        direction: 'TB', // H / V / LR / RL / TB / BT\n        nodeSep: 10,\n        rankSep: 15,\n        padding: [10, 5, 10, 5],\n        fitView: false,\n      }\n    })\n    graph.node(function(node) {\n      let color = '#000';\n      if(node.W) {\n        color = '#fff';\n      }\n      return {\n        label: String(parseInt(node.id)/2+1),\n        style: {\n          fill: color,\n          stroke: '#aaa'\n        }\n      };\n    });\n    // graph.on('node:click', (evt) => {\n    //   const { item, target } = evt;\n    //   const id = parseInt(item._cfg.id);\n    //   // 只能回退到黑棋\n    //   if((id/2+1)%2!==0 && id!==0){\n    //     windowModalComp('提示', '是否回退到该节点', ()=>{\n    //       // go back node i\n    //       console.log('go back to n', id);\n    //       dispatch({type: 'kataData/gobackN', id: id});\n    //     }, ()=>{}, '回退', '取消')\n    //   } else {\n    //     windowModalComp('提示', '只能回退到黑棋', ()=>{}, ()=>{},'好的');\n    //   }\n    // });\n    graph.data(data)\n    graph.render()\n    setGraph(graph);\n    return ()=>{\n      setGraph(null);\n    }\n  }, []);\n\n  useEffect(()=> {\n    if(!(graph instanceof G6.TreeGraph)) {\n      // console.log('no graph', graph);\n      return;\n    }\n    graph.changeData(data);\n    graph.layout(true);\n  });\n\n  return <div id='nodegraph' ref={graphRef}></div>\n}\n\nexport default NodeTreeGraph;\n","import React, {useEffect, useState} from 'react';\nimport {fetchLineData} from '../../api/mock';\n\nimport {Card} from 'antd';\n// import {Line} from '@ant-design/charts';\nimport {useTranslation} from 'react-i18next';\nimport {useSelector} from 'react-redux';\n\nimport NodeTreeGraph from '../nodeTreeGraph';\n\n\nimport './index.css';\n\nconst reconstruct = (obj) => {\n  if (!obj) {\n    return {};\n  }\n  try {\n    if (Object.prototype.toString.call(obj) !== '[object Object]') {\n      obj = JSON.parse(obj);\n    }\n  } catch (e) {\n    console.log('error parse json object:', e);\n    console.log(Object.prototype.toString.call(obj), obj);\n  }\n  if (!obj) {\n    return {};\n  }\n  if (obj.data.B) {\n    obj.B = obj.data.B;\n  } else if (obj.data.W) {\n    obj.W = obj.data.W;\n  }\n  obj.data = null;\n  obj.id = String(obj.id);\n  if (obj.children && Array.isArray(obj.children)) {\n    obj.children.forEach((item) => {\n      reconstruct(item);\n    });\n  }\n  return obj;\n};\n\nexport default function RightPanel() {\n  const {t} = useTranslation();\n  const [lintData, setLineData] = useState(null);\n  const [lineConfig, setLineConfig] = useState([]);\n\n  const kataData = useSelector((state) => state.kataData.kataData);\n  const gameTreeNode = useSelector((state) => state.kataData.gameStatus);\n\n  useEffect(() => {\n    const data = fetchLineData();\n    const lineConfig = {\n        width: 300,\n        height: 150,\n        xField: 'time',\n        yField: 'possibility',\n        render: 'canvas',\n        autoFit: true,\n        point: {\n        size: 5,\n          shape: 'diamond',\n        },\n        label: {\n          style: {\n            fill: '#aaa',\n          },\n        },\n    };\n    setLineConfig(lineConfig);\n    setLineData(data);\n  }, []);\n  const treeData = reconstruct(gameTreeNode);\n  return (\n  <div className='right-panel'>\n    {/* <div className=\"code\">{JSON.stringify(gameTreeNode)}</div> */}\n    <Card className=\"tree-card\" title={t('落子树')}>\n      <div className='tree-canvas'>\n        {JSON.stringify(treeData) !== '{}' && <NodeTreeGraph data={treeData} width={400} height={400} />}\n      </div>\n    </Card>\n    {/* <div className='line-canvas'>\n      {lintData && <Card className=\"win-rate-card\" title={t('胜率图谱')}><Line {...lineConfig} data={lintData} /></Card>}\n    </div> */}\n  </div>);\n};\n","export function aiPlay(ws, board) {\n  // mock AI下棋, 随便往空处下一个\n  const map = board.signMap;\n  const emptyPos = [];\n  map.forEach((row, num)=>{\n    row.forEach((item, letter)=>{\n        if (item===0) {\n          emptyPos.push([num, letter]);\n        }\n    });\n  });\n  if (emptyPos.length === 0) {\n    // 没位置了, 不能下\n    return {\n      errno: 1000,\n      errmsg: '棋盘全满',\n    };\n  }\n  const r = parseInt(Math.random()*emptyPos.length);\n  return {errno: 0, y: emptyPos[r][0], x: emptyPos[r][1]};\n};\n\nexport function fetchLineData() {\n  const data = [\n    {time: 0, possibility: 0},\n    {time: 1, possibility: 0.24},\n    {time: 2, possibility: 0.34},\n    {time: 3, possibility: 0.54},\n    {time: 4, possibility: 0.84},\n    {time: 5, possibility: 0.94},\n  ];\n  return data;\n}\n","import React, {useState} from 'react';\nimport './style.css';\n\nimport {useMount} from 'ahooks';\nimport {useHistory} from 'react-router-dom';\n\nimport {EmptyMap, GameMode, webSocketAddr} from '../../../util/constant.js';\nimport {checkAuth} from '../../../api/user';\nimport WebSocketHelper from '../../../util/websocketHelper';\nimport {useTranslation} from 'react-i18next';\nimport {windowModalComp} from '../../../util/helper';\nimport store from '../../../store/store';\n\n// 组件\nimport CustomGobangBoard from '../../gobanboard/index';\nimport LeftPanel from '../../leftpanel';\nimport RightPanel from '../../rightpanel';\nimport {Modal, Spin} from 'antd';\nimport {Provider} from 'react-redux';\n\n\nconst Home = (props) => {\n  const [gameMode, setGameMode] = useState(GameMode.HumanVSComputer);\n\n  const history = useHistory();\n  const [ws, setWs] = useState(null);\n  const [childrenState, setChildrenState] = useState({});\n  const [childrenStateFn, setChildrenStateFn] = useState({});\n  useMount(async () => {\n    console.log('[LifeCycle] Home Mount');\n    const res = await checkAuth();\n    if (!res.success) {\n      // 需要登录\n      windowModalComp('提示', '请先登录', () => {\n          history.push('/login');\n      });\n      // Modal.info({\n      //   title: '提示',\n      //   content: '请先登录.',\n      //   onOk: () => {\n      //     history.push('/login');\n      //   },\n      // });\n    }\n    const event = {\n      open: function(event) {\n        console.log('[WebSocket] WebSocket connection open');\n      },\n      close: function(event) {\n        console.log('[WebSocket] Connection closed.');\n      },\n      error: function(event) {\n        console.log('[WebSocket] Error:', event);\n      },\n    };\n    const wsHelper = new WebSocketHelper(webSocketAddr, event, true);\n    setWs(wsHelper.ws);\n    // ws = {webSocketAddr}; //test使用\n  });\n\n  // useEffect(() => {\n  //   if (ws && childrenStateFn.setBoard && childrenStateFn.getBoard) {\n  //     // 将组件的状态及变更函数传入,并得到message响应函数\n  //     console.log('[WebSocket] 绑定message事件');\n  //     ws.addEventListener('message', Battle.defineMessage({childrenState, childrenStateFn}));\n  //   }\n  // }, [ws, childrenState, childrenStateFn]);\n\n  const uploadState = (state, setStateFn) => {\n    console.log('[子组件上传]', state, setStateFn);\n    state && setChildrenState({...childrenState, ...state});\n    setStateFn && setChildrenStateFn({...childrenStateFn, ...setStateFn});\n  };\n\n  return (\n    <Provider store={store} >\n    <div className='home'>\n      {\n      !ws &&\n        <div className='home-spin'>\n          <Spin tip=\"加载中...\" />\n        </div>\n      }\n      <LeftPanel\n        changeGameMode={setGameMode}\n        mode={gameMode}\n        ws={ws}\n      />\n      <CustomGobangBoard\n        setLoading={props.setLoading}\n        signMap={EmptyMap}\n        showCoordinates={true}\n        fuzzyStonePlacement={false}\n        mode={gameMode}\n        ws={ws}\n        uploadState={uploadState}\n      />\n      <RightPanel />\n    </div></Provider>);\n};\nexport default Home;\n","import React, {useEffect, useState} from 'react';\nimport {login, checkAuth} from '../../api/user';\nimport {useMount} from 'ahooks';\nimport Cookies from 'js-cookie';\nimport {useHistory} from 'react-router-dom';\nimport {registry} from '../../api/user';\nimport {useTranslation} from 'react-i18next';\nimport {translate} from '../../util/helper';\n\n\nimport './index.css';\n\n\nimport {Modal} from 'antd';\n\nfunction errorModal(title, content) {\n  const tTitle = translate(title);\n  const tContent = translate(content);\n  // console.log(tTitle, tContent);\n  Modal.error({\n    title: tTitle,\n    content: tContent,\n  });\n}\n\nconst layout = {\n  labelCol: {\n    span: 8,\n  },\n  wrapperCol: {\n    span: 16,\n  },\n};\nconst tailLayout = {\n  wrapperCol: {\n    offset: 8,\n    span: 16,\n  },\n};\n\n\nconst LoginSignup = () => {\n  const {t} = useTranslation();\n  const history = useHistory();\n  const [name, setName] = useState(null);\n  const [password, setPassword] = useState(null);\n  const [repeatPassword, setRepeatPassword] = useState(null);\n  const [loginInLeftPanel, setLoginInLeftPanel] = useState(true);\n\n  useMount(async () => {\n    const auth = Cookies.get('auth');\n    // const res = await checkAuth();\n    // if (res.success) {\n    //   // 免登录\n    //   history.push('/home');\n    // }\n  });\n  const signin = async () => {\n    const res = await login(name, password);\n    if (res.success) {\n      const {data} = res;\n      Cookies.set('auth', data.AuthToken);\n      Cookies.set('userName', data.UserName);\n      Cookies.set('userId', data.UserId);\n      console.log('[Router] 从login跳转到home');\n      history.push('/home');\n    } else {\n      console.log('[*]登录失败', res);\n      errorModal('失败', '登录失败');\n    }\n  };\n\n  const signUp = async () => {\n    if ((repeatPassword !== password) || (repeatPassword == null)) {\n      return;\n    }\n\n    const res = await registry(name, password);\n    if (res.success) {\n      const {data} = res;\n      Cookies.set('auth', data.AuthToken);\n      Cookies.set('userName', data.UserName);\n      Cookies.set('userId', data.UserId);\n      console.log('[Router] 从registry跳转到login');\n      setLoginInLeftPanel(true);\n    } else {\n      // TODO 此处提示不生效\n      errorModal('失败', '注册账号失败,请稍后再试');\n    }\n  };\n\n  function changePanel() {\n    setLoginInLeftPanel(!loginInLeftPanel);\n    setName(null);\n    setPassword(null);\n    setRepeatPassword(null);\n  }\n\n\n  return (\n\n\n    <div className=\"login-container\" id=\"container\">\n      {loginInLeftPanel &&\n        <div className='login'>\n          <div className=\"form-container\">\n            <div className=\"sign-in-container\">\n              <h1 className = \"signin-h1\">{t('登录')}</h1>\n              <input type=\"text\" placeholder={t('用户名')} onChange={(e) => setName(e.target.value)} />\n              <input type=\"password\" placeholder={t('密码')} onChange={(e) => setPassword(e.target.value)}/>\n              <a className=\"forget-password\" href=\"#\">{t('忘记密码')}?</a>\n              <button className=\"login-button\" onClick={signin}>{t('登录')}</button>\n            </div>\n            <div className=\"overlay-container\">\n              <div className=\"overlay\">\n                <div className=\"overlay-panel overlay-right\">\n                  <h1 className=\"login-h1\">{t('围棋Katago')}</h1>\n                  <p>{t('欢迎加入围棋katago')}</p>\n                  <button className=\"login-button\" id=\"signUp\" onClick = {changePanel}>{t('注册')}</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      }\n      { (!loginInLeftPanel) &&\n        <div className='signUp'>\n          <div className=\"form-container\">\n            <div className=\"sign-in-container\">\n              <h1 className = \"signin-h1\">{t('注册')}</h1>\n              <input type=\"text\" placeholder={t('用户名')} onChange={(e) => setName(e.target.value)} />\n              <input type=\"password\" placeholder={t('密码')} onChange={(e) => setPassword(e.target.value)}/>\n              <input type=\"password\" placeholder={t('重复密码')} onChange={(e) => setRepeatPassword(e.target.value)}/>\n              <button className=\"login-button\" onClick={signUp}>{t('注册')}</button>\n            </div>\n            <div className=\"overlay-container\">\n              <div className=\"overlay\">\n                <div className=\"overlay-panel overlay-right\">\n                  <h1 className=\"login-h1\">{t('围棋Katago')}</h1>\n                  <p>{t('欢迎登录围棋katago')}</p>\n                  <button className=\"login-button\" id=\"signUp\" onClick = {changePanel}>{t('登录')}</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      }\n    </div>\n\n  );\n};\nexport default LoginSignup;\n","import React, {useEffect, useState} from 'react';\nimport './index.css';\nimport {registry} from '../../api/user';\nimport Cookies from 'js-cookie';\nimport {useHistory} from 'react-router-dom';\n\nimport {Form, Input, Button, Modal} from 'antd';\n\nconst layout = {\n  labelCol: {\n    span: 8,\n  },\n  wrapperCol: {\n    span: 16,\n  },\n};\nconst tailLayout = {\n  wrapperCol: {\n    offset: 8,\n    span: 16,\n  },\n};\n\nfunction errorModal(title, content) {\n  Modal.error({\n    title,\n    content,\n  });\n}\n\nconst Registry = (props) => {\n  const history = useHistory();\n  const [name, setName] = useState(null);\n  const [password, setPassword] = useState(null);\n  const [repeatPassword, setRepeatPassword] = useState(null);\n\n  const registryAccount = async () => {\n    if (repeatPassword !== password) {\n      return;\n    }\n\n    const res = await registry(name, password);\n    if (res.success) {\n      const {data} = res;\n      Cookies.set('auth', data.AuthToken);\n      Cookies.set('userName', data.UserName);\n      Cookies.set('userId', data.UserId);\n      console.log('[Router] 从registry跳转到login');\n      history.push('/login');\n    } else {\n      errorModal('失败', '注册账号失败,请稍后再试.');\n    }\n  };\n\n  return (\n    <div className=\"registry-container\">\n      <Form\n        {...layout}\n        onFinish={registryAccount}\n        onFinishFailed={registryAccount}\n        className=\"registry-form\"\n      >\n        <Form.Item\n          label=\"账号\"\n          name=\"账号\"\n          rules={[\n            {\n              required: true,\n              message: '请输入账号',\n            },\n          ]}\n          onChange={(e) => setName(e.target.value)}\n        >\n          <Input />\n        </Form.Item>\n\n        <Form.Item\n          label=\"密码\"\n          name=\"密码\"\n          rules={[\n            {\n              required: true,\n              message: '请输入密码',\n            },\n          ]}\n          onChange={(e) => setPassword(e.target.value)}\n        >\n          <Input.Password />\n        </Form.Item>\n\n        <Form.Item\n          label=\"重复密码\"\n          name=\"重复密码\"\n          rules={[\n            {\n              required: true,\n              message: '请输入相同的密码',\n            },\n          ]}\n          onChange={(e) => setRepeatPassword(e.target.value)}\n        >\n          <Input.Password />\n        </Form.Item>\n\n        <Form.Item {...tailLayout}>\n          <Button type=\"primary\" htmlType=\"submit\">\n            注册\n          </Button>\n        </Form.Item>\n      </Form>\n    </div>\n  );\n};\nexport default Registry;\n","import {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from 'react-router-dom';\n\nimport {Header} from './header';\nimport {useState} from 'react';\n\nimport 'antd/dist/antd.css';\n\n// Code-splitting is automated for `routes` directory\nimport Home from './routes/home';\nimport Login from '../components/login';\nimport Registry from '../components/register';\nimport {Spin} from 'antd';\n\n\nconst App = () => {\n  const [loading, setLoading] = useState(false);\n  return (\n  <div id=\"app\">\n    <div style={{width: '100%', backgroundColor: '#999', zIndex: 999}}>\n      {loading && <Spin />}\n    </div>\n    <Router>\n      <Header />\n      <Switch>\n          <Route exact path=\"/\">\n            <Home setLoading={setLoading} />\n          </Route>\n          <Route exact path=\"/home\">\n            <Home setLoading={setLoading} />\n          </Route>\n          <Route path=\"/login\">\n            <Login />\n          </Route>\n          <Route path=\"/registry\">\n            <Registry />\n          </Route>\n        </Switch>\n    </Router>\n  </div>);\n};\n\nexport default App;\n","import App from './components/app.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'babel-polyfill';\nimport './i18n';\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n","const iconv = (() => {\n  try {\n    const m = require('iconv-lite');\n    if (m == null) throw new Error();\n\n    return m;\n  } catch (err) {\n    return {\n      encodingExists: () => true,\n      decode: (buffer) => buffer.toString(),\n      encode: (str, _) => str,\n    };\n  }\n})();\n\nexport default iconv;\n"," const jschardet = (() => {\n  try {\n    const m = require('jschardet');\n    if (m == null) throw new Error();\n\n    return m;\n  } catch (err) {\n    return {\n      detect: () => ({encoding: 'UTF-8'}),\n    };\n  }\n})();\n\nexport default jschardet;\n","import helper from '../../components/goboard/helper';\n\nconst alpha = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst escapeString = function(input) {\n  return input\n    .toString()\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/\\]/g, '\\\\]');\n};\n\nconst unescapeString = function(input) {\n  const result = [];\n  let inBackslash = false;\n\n  input = input.replace(/\\r/g, '');\n\n  for (let i = 0; i < input.length; i++) {\n    if (!inBackslash) {\n      if (input[i] !== '\\\\') result.push(input[i]);\n      else if (input[i] === '\\\\') inBackslash = true;\n    } else {\n      if (input[i] !== '\\n') result.push(input[i]);\n\n      inBackslash = false;\n    }\n  }\n\n  return result.join('');\n};\n\nconst parseDates = function(input) {\n  if (\n    !input.match(\n      // eslint-disable-next-line max-len\n      /^(\\d{4}(-\\d{1,2}(-\\d{1,2})?)?(\\s*,\\s*(\\d{4}|(\\d{4}-)?\\d{1,2}(-\\d{1,2})?))*)?$/,\n    )\n  ) {\nreturn null;\n}\n\n  if (input.trim() === '') return [];\n\n  const dates = input.split(',').map((x) => x.trim().split('-'));\n\n  for (let i = 1; i < dates.length; i++) {\n    const date = dates[i];\n    const prev = dates[i - 1];\n\n    if (date[0].length !== 4) {\n      // No year\n\n      if (date.length === 1 && prev.length === 3) {\n        // Add month\n        date.unshift(prev[1]);\n      }\n\n      // Add year\n      date.unshift(prev[0]);\n    }\n  }\n\n  return dates.map((x) => x.map((y) => +y));\n};\n\nconst stringifyDates = function(dates) {\n  if (dates.length === 0) return '';\n\n  const datesCopy = [dates[0].slice()];\n\n  for (let i = 1; i < dates.length; i++) {\n    const date = dates[i];\n    const prev = dates[i - 1];\n    let k = 0;\n\n    for (let j = 0; j < date.length; j++) {\n      if (date[j] === prev[j] && k === j) k++;\n      else break;\n    }\n\n    datesCopy.push(date.slice(k));\n  }\n\n  return datesCopy\n    .map((x) => x.map((y) => (y > 9 ? '' + y : '0' + y)).join('-'))\n    .join(',');\n};\n\nconst parseVertex = function(input) {\n  if (input.length !== 2) return [-1, -1];\n  return input.split('').map((x) => alpha.indexOf(x));\n};\n\nconst stringifyVertex = function([x, y]) {\n  if (Math.min(x, y) < 0 || Math.max(x, y) >= alpha.length) return '';\n  return alpha[x] + alpha[y];\n};\n\nconst parseCompressedVertices = function(input) {\n  const colon = input.indexOf(':');\n  if (colon < 0) return [parseVertex(input)];\n\n  const [x1, y1] = parseVertex(input.slice(0, colon));\n  const [x2, y2] = parseVertex(input.slice(colon + 1));\n  const vertices = [];\n\n  for (let i = Math.min(x1, x2); i <= Math.max(x1, x2); i++) {\n    for (let j = Math.min(y1, y2); j <= Math.max(y1, y2); j++) {\n      vertices.push([i, j]);\n    }\n  }\n\n  return vertices;\n};\n\nconst sgfHelper = {\n  alpha,\n  escapeString,\n  unescapeString,\n  parseDates,\n  stringifyDates,\n  stringifyVertex,\n  parseVertex,\n  parseCompressedVertices,\n};\n\nexport default sgfHelper;\n","import {createTokenizer, regexRule} from 'doken';\nimport iconv from './iconv-lite';\nimport jschardet from './jschardet';\nimport helper from './helper';\nconst {unescapeString} = helper;\n\nconst encodingDetectionProps = [\n  'EV',\n  'GN',\n  'GC',\n  'AN',\n  'BT',\n  'WT',\n  'PW',\n  'PB',\n  'C',\n];\n\nconst _tokenize = createTokenizer({\n  rules: [\n    regexRule('_whitespace', /\\s+/y, {lineBreaks: true}),\n    regexRule('parenthesis', /(\\(|\\))/y),\n    regexRule('semicolon', /;/y),\n    regexRule('prop_ident', /[A-Za-z]+/y),\n    regexRule('c_value_type', /\\[([^\\\\\\]]|\\\\[^])*\\]/y, {lineBreaks: true}),\n    {\n      type: 'invalid',\n      match: (input, position) => ({length: 1}),\n    },\n  ],\n});\n\nconst tokenizeIter = function* (contents) {\n  for (const token of _tokenize(contents)) {\n    token.progress = token.pos / (contents.length - 1);\n    delete token.length;\n\n    yield token;\n  }\n};\n\nconst tokenizeBufferIter = function* (buffer, {encoding = null} = {}) {\n  if (encoding != null) {\n    yield* tokenizeIter(iconv.decode(buffer, encoding));\n    return;\n  }\n\n  // Guess encoding\n\n  const detectedEncoding = jschardet.detect(buffer.slice(0, 300)).encoding;\n  const contents = iconv.decode(buffer, detectedEncoding);\n  const tokens = tokenizeIter(contents);\n\n  // Search for encoding\n\n  const prelude = [];\n\n  while (true) {\n    const next = tokens.next();\n    if (next.done) break;\n\n    const {type, value} = next.value;\n    const lastToken = prelude[prelude.length - 1];\n\n    prelude.push(next.value);\n\n    if (\n      type === 'c_value_type' &&\n      lastToken != null &&\n      lastToken.type === 'prop_ident' &&\n      lastToken.value === 'CA'\n    ) {\n      encoding = unescapeString(value.slice(1, -1));\n      break;\n    }\n  }\n\n  if (\n    encoding != null &&\n    encoding != detectedEncoding &&\n    iconv.encodingExists(encoding)\n  ) {\n    yield* tokenizeIter(iconv.decode(buffer, encoding));\n  } else {\n    yield* prelude;\n    yield* tokens;\n  }\n};\n\nconst tokenize = (contents) => [...tokenizeIter(contents)];\n\nconst tokenizeBuffer = (buffer, opts) => [\n  ...tokenizeBufferIter(buffer, opts),\n];\n\nconst token = {\n  encodingDetectionProps,\n  tokenizeIter,\n  tokenizeBufferIter,\n  tokenize,\n  tokenizeBuffer,\n};\n\nexport default token;\n","class Peekable {\n  constructor(iterator) {\n    this.iterator = iterator[Symbol.iterator]();\n    this.peekedItem = null;\n    this.peeked = false;\n  }\n\n  next() {\n    const next = this.peeked ? this.peekedItem : this.iterator.next();\n\n    this.peekedItem = null;\n    this.peeked = false;\n\n    return next;\n  }\n\n  peek() {\n    if (!this.peeked) {\n      this.peekedItem = this.iterator.next();\n      this.peeked = true;\n    }\n\n    return this.peekedItem;\n  }\n}\n\nexport default Peekable;\n","\n\nimport Peekable from './peekable';\nimport tokenize from './tokenize';\nimport helper from './helper';\nconst {unescapeString} = helper;\nconst {tokenizeIter, tokenizeBufferIter} = tokenize;\n\n\nfunction _parseTokens(peekableTokens, parentId, options) {\n  const {getId, dictionary, onProgress, onNodeCreated} = options;\n\n  let anchor = null;\n  let node; let property;\n\n  while (!peekableTokens.peek().done) {\n    const {type, value, row, col} = peekableTokens.peek().value;\n\n    if (type === 'parenthesis' && value === '(') break;\n    if (type === 'parenthesis' && value === ')') {\n      if (node != null) onNodeCreated({node});\n      return anchor;\n    }\n\n    if (type === 'semicolon' || node == null) {\n      // Prepare new node\n\n      const lastNode = node;\n\n      node = {\n        id: getId(),\n        data: {},\n        parentId: lastNode == null ? parentId : lastNode.id,\n        children: [],\n      };\n\n      if (dictionary != null) dictionary[node.id] = node;\n\n      if (lastNode != null) {\n        onNodeCreated({node: lastNode});\n        lastNode.children.push(node);\n      } else {\n        anchor = node;\n      }\n    }\n\n    if (type === 'semicolon') {\n      // Work is already done\n    } else if (type === 'prop_ident') {\n      if (node != null) {\n        // Prepare new property\n\n        const identifier =\n          value === value.toUpperCase() ?\n            value :\n            value\n                .split('')\n                .filter((x) => x.toUpperCase() === x)\n                .join('');\n\n        if (identifier !== '') {\n          if (!(identifier in node.data)) node.data[identifier] = [];\n          property = node.data[identifier];\n        } else {\n          property = null;\n        }\n      }\n    } else if (type === 'c_value_type') {\n      if (property != null) {\n        property.push(unescapeString(value.slice(1, -1)));\n      }\n    } else if (type === 'invalid') {\n      throw new Error(`Unexpected token at ${row + 1}:${col + 1}`);\n    } else {\n      throw new Error(\n        `Unexpected token type '${type}' at ${row + 1}:${col + 1}`,\n      );\n    }\n\n    peekableTokens.next();\n  }\n\n  if (node == null) {\n    anchor = node = {\n      id: null,\n      data: {},\n      parentId: null,\n      children: [],\n    };\n  } else {\n    onNodeCreated({node});\n  }\n\n  while (!peekableTokens.peek().done) {\n    const {type, value, progress} = peekableTokens.peek().value;\n\n    if (type === 'parenthesis' && value === '(') {\n      peekableTokens.next();\n\n      const child = _parseTokens(peekableTokens, node.id, options);\n\n      if (child != null) {\n        node.children.push(child);\n      }\n    } else if (type === 'parenthesis' && value === ')') {\n      onProgress({progress});\n      break;\n    }\n\n    peekableTokens.next();\n  }\n\n  return anchor;\n}\n\nconst parseTokens = function(\n  tokens,\n  {\n    getId = ((id) => () => id++)(0),\n    dictionary = null,\n    onProgress = () => {},\n    onNodeCreated = () => {},\n  } = {},\n) {\n  const node = _parseTokens(new Peekable(tokens), null, {\n    getId,\n    dictionary,\n    onProgress,\n    onNodeCreated,\n  });\n\n  return node.id == null ? node.children : [node];\n};\n\nconst parse = function(contents, options = {}) {\n  return parseTokens(tokenizeIter(contents), options);\n};\n\nconst parseBuffer = function(buffer, options = {}) {\n  return parseTokens(\n    tokenizeBufferIter(buffer, {encoding: options.encoding}),\n    options,\n  );\n};\n\nconst parseLib = {\n parse,\n parseTokens,\n parseBuffer,\n};\n\nexport default parseLib;\n\n// const parseFile = function(filename, options = {}) {\n//   return const parseBuffer(fs.readFileSync(filename), options);\n// };\n","import helper from './helper';\nconst {escapeString} = helper;\n\nconst stringify = function(\n  node,\n  {linebreak = '\\n', indent = '  ', level = 0} = {},\n) {\n  if (Array.isArray(node)) {\n    return stringify({children: node}, {linebreak, level});\n  }\n\n  const output = [];\n  const totalIndent = linebreak !== '' ? indent.repeat(level) : '';\n\n  if (node.data != null) {\n    output.push(totalIndent, ';');\n\n    for (const id in node.data) {\n      if (id.toUpperCase() !== id) continue;\n\n      output.push(id, '[', node.data[id].map(escapeString).join(']['), ']');\n    }\n\n    output.push(linebreak);\n  }\n\n  if (node.children.length > 1 || (node.children.length > 0 && level === 0)) {\n    output.push(totalIndent);\n\n    for (const child of node.children) {\n      output.push(\n        '(',\n        linebreak,\n        stringify(child, {linebreak, level: level + 1}),\n        totalIndent,\n        ')',\n      );\n    }\n\n    output.push(linebreak);\n  } else if (node.children.length === 1) {\n    output.push(stringify(node.children[0], {linebreak, level}));\n  }\n\n  return output.join('');\n};\n\nexport default stringify;\n","import tokenizelib from './tokenize';\nimport parseLib from './parse';\nimport stringify from './stringify';\nimport helper from './helper';\nconst {\n    tokenizeIter,\n    tokenizeBufferIter,\n    tokenize,\n    tokenizeBuffer,\n} = tokenizelib;\n/* eslint-disable */\nconst { parse, parseTokens, parseBuffer } = parseLib;\n\n// Object.assign(\n//   exports,\n//   {\n//     tokenizeIter,\n//     tokenizeBufferIter,\n//     tokenize,\n//     tokenizeBuffer,\n//     parse,\n//     parseTokens,\n//     parseBuffer,\n//     parseFile,\n//     stringify,\n//   },\n//   helper,\n// );\n\n// Object.assign(\n//   exports,\n//   {\n//     tokenizeIter,\n//     tokenizeBufferIter,\n//     tokenize,\n//     tokenizeBuffer,\n//     parse,\n//     parseTokens,\n//     parseBuffer,\n//     stringify,\n//   },\n//   helper,\n// );\n\nexport default {\n    tokenizeIter,\n    tokenizeBufferIter,\n    tokenize,\n    tokenizeBuffer,\n    parse,\n    parseTokens,\n    parseBuffer,\n    stringify,\n    stringifyVertex: helper.stringifyVertex,\n    helper,\n};","const alpha = 'ABCDEFGHJKLMNOPQRSTUVWXYZ';\nconst vertexEvents = [\n  'Click',\n  'MouseDown',\n  'MouseUp',\n  'MouseMove',\n  'MouseEnter',\n  'MouseLeave',\n];\n\nconst range = function(n) {\n  return Array(n).fill(0).map((_, i) => i);\n};\nconst random = (n) => Math.floor(Math.random() * (n + 1));\nconst neighborhood = ([x, y]) => [\n  [x, y],\n  [x - 1, y],\n  [x + 1, y],\n  [x, y - 1],\n  [x, y + 1],\n];\nconst vertexEquals = ([x1, y1], [x2, y2]) => x1 === x2 && y1 === y2;\nconst lineEquals = ([v1, w1], [v2, w2]) =>\n  vertexEquals(v1, v2) && vertexEquals(w1, w2);\n\nconst getHoshis = function(width, height) {\n  if (Math.min(width, height) <= 6) return [];\n\n  const [nearX, nearY] = [width, height].map((x) => (x >= 13 ? 3 : 2));\n  const [farX, farY] = [width - nearX - 1, height - nearY - 1];\n  const [middleX, middleY] = [width, height].map((x) => (x - 1) / 2);\n\n  const result = [\n    [nearX, farY],\n    [farX, nearY],\n    [farX, farY],\n    [nearX, nearY],\n  ];\n\n  if (width % 2 !== 0 && height % 2 !== 0 && width !== 7 && height !== 7) {\nresult.push([middleX, middleY]);\n}\n  if (width % 2 !== 0 && width !== 7) {\nresult.push([middleX, nearY], [middleX, farY]);\n}\n  if (height % 2 !== 0 && height !== 7) {\nresult.push([nearX, middleY], [farX, middleY]);\n}\n\n  return result;\n};\n\nconst readjustShifts = function(shiftMap, vertex = null) {\n  if (vertex == null) {\n    for (let y = 0; y < shiftMap.length; y++) {\n      for (let x = 0; x < shiftMap[0].length; x++) {\n        readjustShifts(shiftMap, [x, y]);\n      }\n    }\n  } else {\n    const [x, y] = vertex;\n    const direction = shiftMap[y][x];\n\n    const data = [\n      // Left\n      [\n        [1, 5, 8],\n        [x - 1, y],\n        [3, 7, 6],\n      ],\n      // Top\n      [\n        [2, 5, 6],\n        [x, y - 1],\n        [4, 7, 8],\n      ],\n      // Right\n      [\n        [3, 7, 6],\n        [x + 1, y],\n        [1, 5, 8],\n      ],\n      // Bottom\n      [\n        [4, 7, 8],\n        [x, y + 1],\n        [2, 5, 6],\n      ],\n    ];\n\n    for (const [directions, [qx, qy], removeShifts] of data) {\n      if (!directions.includes(direction)) continue;\n\n      if (shiftMap[qy] && removeShifts.includes(shiftMap[qy][qx])) {\n        shiftMap[qy][qx] = 0;\n      }\n    }\n  }\n\n  return shiftMap;\n};\n\nconst diffSignMap = function(before, after) {\n  if (\n    before === after ||\n    before.length === 0 ||\n    before.length !== after.length ||\n    before[0].length !== after[0].length\n  ) {\n    return [];\n  }\n\n  const result = [];\n\n  for (let y = 0; y < before.length; y++) {\n    for (let x = 0; x < before[0].length; x++) {\n      if (before[y][x] === 0 && after[y] != null && after[y][x]) {\n        result.push([x, y]);\n      }\n    }\n  }\n\n  return result;\n};\n\nconst helper = {\n  alpha,\n  vertexEvents,\n  vertexEquals,\n  range,\n  random,\n  neighborhood,\n  lineEquals,\n  getHoshis,\n  readjustShifts,\n  diffSignMap,\n};\n\nexport default helper;\n"],"sourceRoot":""}